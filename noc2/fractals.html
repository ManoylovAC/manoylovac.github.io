<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.25.7"/><meta data-react-helmet="true" name="description" content="Колись у середній школі я вивчав курс геометрії. Можливо, ви теж пройшли такий курс, де дізналися про класичні форми в одному, двох і, можливо, навіть"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:url" content="https://natureofcode.com"/><meta data-react-helmet="true" property="og:image" content="https://natureofcode.com/static/7dd3422c43faa1513528cd25636d9e6b/b08a9/cover.png"/><meta data-react-helmet="true" property="og:title" content="8. Фрактали"/><meta data-react-helmet="true" property="og:description" content="Колись у середній школі я вивчав курс геометрії. Можливо, ви теж пройшли такий курс, де дізналися про класичні форми в одному, двох і, можливо, навіть"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:title" content="8. Фрактали"/><meta data-react-helmet="true" name="twitter:description" content="Колись у середній школі я вивчав курс геометрії. Можливо, ви теж пройшли такий курс, де дізналися про класичні форми в одному, двох і, можливо, навіть"/><meta data-react-helmet="true" name="twitter:image" content="https://natureofcode.com/static/7dd3422c43faa1513528cd25636d9e6b/b08a9/cover.png"/>

  <link rel="stylesheet" href="./assets/styles/global.css">

  <noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="icon" href="./favicon-32x32.png" type="image/png"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png"/><title data-react-helmet="true">8. Фрактали / Nature of Code</title></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><header class="fixed left-0 right-0 top-0 z-40 bg-white px-6 lg:px-8"><div class="mx-auto flex h-[5em] max-w-6xl items-center justify-between"><div class="flex flex-col gap-x-6 lg:flex-row lg:items-center"><a href="./"><span class="text-lg font-black tracking-widest text-noc-400"><span class="font-black">ПРИРОДА</span> КОДУ</span></a><span class="hidden text-sm tracking-widest text-noc-400 xl:block">ДАНІЕЛЬ ШИФФМАН</span></div><button class="flex h-9 w-11 cursor-pointer flex-col items-center justify-between p-2 lg:hidden" aria-label="Toggle menu" title="Toggle menu"><span class="block h-0.5 w-full rounded bg-noc-200 transition-transform"></span><span class="block h-0.5 w-full rounded bg-noc-200 transition-opacity" style="opacity:1"></span><span class="block h-0.5 w-full rounded bg-noc-200 transition-transform"></span></button><div class="hidden items-center gap-6 lg:flex"><ul class="flex items-center gap-6"><li><a href="https://github.com/sponsors/CodingTrain" class="flex items-center gap-1.5 text-sm text-gray-500 hover:underline"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="text-noc-200" height="1.2em" width="1.2em" xmlns="http://www.w3.org/2000/svg"><path d="M458.4 64.3C400.6 15.7 311.3 23 256 79.3 200.7 23 111.4 15.6 53.6 64.3-21.6 127.6-10.6 230.8 43 285.5l175.4 178.7c10 10.2 23.4 15.9 37.6 15.9 14.3 0 27.6-5.6 37.6-15.8L469 285.6c53.5-54.7 64.7-157.9-10.6-221.3zm-23.6 187.5L259.4 430.5c-2.4 2.4-4.4 2.4-6.8 0L77.2 251.8c-36.5-37.2-43.9-107.6 7.3-150.7 38.9-32.7 98.9-27.8 136.5 10.5l35 35.7 35-35.7c37.8-38.5 97.8-43.2 136.5-10.6 51.1 43.1 43.5 113.9 7.3 150.8z"></path></svg>SUPPORT</a></li><li><a href="https://github.com/nature-of-code/noc-book-2" class="flex items-center gap-1.5 text-sm text-gray-500 hover:underline"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" class="text-noc-200" height="1.2em" width="1.2em" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>GITHUB</a></li><li><a href="https://thecodingtrain.com/" class="flex items-center text-sm text-gray-500 hover:underline"><img src="./static/codingtrain_logo-53b0a841be45c7eac7a12f88b7bea596.png" alt="Coding Train&#x27;s logo" class="-ml-2 w-8"/>CODING TRAIN</a></li></ul><div class="not-prose flex items-center gap-4 undefined"><div class="relative"><a href="https://natureofcode.com/" target="_blank" class="flex items-center text-sm text-gray-500 hover:underline"><img src="./favicon-32x32.png" alt="The Nature Of Code logo" class="noc2-logo"/>THE NATURE OF CODE</a></div></div></div></div></header>
  <nav class="fixed bottom-0 left-0 right-0 top-[5em] z-20 overflow-y-auto bg-white px-6 lg:hidden mb-menu hidden">
    <ul class="my-7 space-y-2">
      <li><a class="text-lg text-gray-800" href="./dedication.html">Присвята</a></li>
      <li><a class="text-lg text-gray-800" href="./acknowledgements.html">Подяки</a></li>
      <li><a class="text-lg text-gray-800" href="./introduction.html">Вступ</a></li>
      <li>
        <button class="sub-menu-btn flex items-center gap-2 text-lg text-gray-800">
          <span>Розділи</span>
          <svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5 transition-transform" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg" style="transform: scaleY(1);"><polyline points="6 9 12 15 18 9"></polyline></svg>
        </button>
        <ul class="space-y-2 py-2 pl-4 sub-menu hidden">
          <li><a class="flex items-center text-gray-600" href="./random.html"><span class="w-8">0</span><span>Випадковість</span></a></li>
          <li><a class="flex items-center text-gray-600" href="./vectors.html"><span class="w-8">1</span><span>Вектори</span></a></li>
          <li><a class="flex items-center text-gray-600" href="./forces.html"><span class="w-8">2</span><span>Сили</span></a></li>
          <li><a class="flex items-center text-gray-600" href="./oscillation.html"><span class="w-8">3</span><span>Коливання</span></a></li>
          <li><a class="flex items-center text-gray-600" href="./particles.html"><span class="w-8">4</span><span>Система частинок</span></a></li>
          <li><a class="flex items-center text-gray-600" href="./autonomous-agents.html"><span class="w-8">5</span><span>Автономні агенти</span></a></li>
          <li><a class="flex items-center text-gray-600" href="./physics-libraries.html"><span class="w-8">6</span><span>Фізичні бібліотеки</span></a></li>
          <li><a class="flex items-center text-gray-600" href="./cellular-automata.html"><span class="w-8">7</span><span>Клітинні автомати</span></a></li>
          <li><a aria-current="page" class="flex items-center text-gray-600 font-bold" href="./fractals.html"><span class="w-8">8</span><span>Фрактали</span></a></li>
          <li><a class="flex items-center text-gray-600" href="./genetic-algorithms.html"><span class="w-8">9</span><span>Еволюційне моделювання</span></a></li>
          <li><a class="flex items-center text-gray-600" href="./neural-networks.html"><span class="w-8">10</span><span>Нейронні мережі</span></a></li>
          <li><a class="flex items-center text-gray-600" href="./neuroevolution.html"><span class="w-8">11</span><span>Нейроеволюція</span></a></li>
        </ul>
      </li>
      <li><a class="text-lg text-gray-800" href="./appendix-creature.html">Додаток: Дизайн створінь</a></li>
      <li><a class="text-lg text-gray-800" href="./resources.html">Додаткові ресурси</a></li>
      <li><a class="text-lg text-gray-800" href="./credits.html">Credits</a></li>
      <li><a class="text-lg text-gray-800" href="./translation.html">Про переклад</a></li>
      <li><a class="text-lg text-gray-800" href="./examples.html">Приклади</a></li>
    </ul>
    <ul class="my-7 space-y-2">
      <li><a target="_blank" href="https://github.com/sponsors/CodingTrain" class="flex items-center gap-1 text-lg text-gray-800">Support<svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="w-3.5 text-gray-400" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></a></li>
      <li><a target="_blank" href="https://github.com/nature-of-code/noc-book-2" class="flex items-center gap-1 text-lg text-gray-800">GitHub<svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="w-3.5 text-gray-400" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></a></li>
      <li><a target="_blank" href="https://thecodingtrain.com/" class="flex items-center gap-1 text-lg text-gray-800">Coding Train<svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="w-3.5 text-gray-400" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></a></li>

      <li><a target="_blank" href="https://natureofcode.com/" class="flex items-center gap-1 text-lg text-gray-800">The Nature Of Code<svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="w-3.5 text-gray-400" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></a></li>
    </ul>
  </nav>
  <div class="mt-[6em] px-6 lg:px-8"><div class="mx-auto max-w-6xl lg:flex lg:justify-between lg:gap-10 xl:gap-14"><aside class="sticky top-[6em] z-10 hidden max-h-[calc(100vh-6em)] min-w-[14em] overflow-y-auto pb-8 lg:block lg:flex-grow"><nav class="border-noc-200 rounded-3xl border"><ul class="divide-noc-200 divide-y"><li><a class="relative block px-3 py-2 text-sm hover:underline" href="./dedication.html">Присвята</a></li><li><a class="relative block px-3 py-2 text-sm hover:underline" href="./acknowledgements.html">Подяки</a></li><li><a class="relative block px-3 py-2 text-sm hover:underline" href="./introduction.html">Вступ</a></li><li><a class="group relative flex items-center px-3 py-2 text-sm" href="./random.html"><span class="w-8">0</span><span class="group-hover:underline">Випадковість</span></a></li><li><a class="group relative flex items-center px-3 py-2 text-sm" href="./vectors.html"><span class="w-8">1</span><span class="group-hover:underline">Вектори</span></a></li><li><a class="group relative flex items-center px-3 py-2 text-sm" href="./forces.html"><span class="w-8">2</span><span class="group-hover:underline">Сили</span></a></li><li><a class="group relative flex items-center px-3 py-2 text-sm" href="./oscillation.html"><span class="w-8">3</span><span class="group-hover:underline">Коливання</span></a></li><li><a class="group relative flex items-center px-3 py-2 text-sm" href="./particles.html"><span class="w-8">4</span><span class="group-hover:underline">Системи частинок</span></a></li><li><a class="group relative flex items-center px-3 py-2 text-sm" href="./autonomous-agents.html"><span class="w-8">5</span><span class="group-hover:underline">Автономні агенти</span></a></li><li><a class="group relative flex items-center px-3 py-2 text-sm" href="./physics-libraries.html"><span class="w-8">6</span><span class="group-hover:underline">Фізичні бібліотеки</span></a></li><li><a class="group relative flex items-center px-3 py-2 text-sm" href="./cellular-automata.html"><span class="w-8">7</span><span class="group-hover:underline">Клітинні автомати</span></a></li><li><a aria-current="page" class="group relative flex items-center px-3 py-2 text-sm font-bold" href="./fractals.html"><span class="w-8">8</span><span class="group-hover:underline">Фрактали</span></a><ul class="space-y-1 pb-2"><li><a href="#what-is-a-fractal" class="ml-11 block py-0.5 pr-2 text-sm text-gray-500 hover:underline false">Що таке фрактал?</a></li><li><a href="#recursion" class="ml-11 block py-0.5 pr-2 text-sm text-gray-500 hover:underline false">Рекурсія</a></li><li><a href="#the-koch-curve" class="ml-11 block py-0.5 pr-2 text-sm text-gray-500 hover:underline false">Крива Коха</a></li><li><a href="#trees" class="ml-11 block py-0.5 pr-2 text-sm text-gray-500 hover:underline false">Дерева</a></li><li><a href="#l-systems" class="ml-11 block py-0.5 pr-2 text-sm text-gray-500 hover:underline false">L-системи</a></li></ul></li><li><a class="group relative flex items-center px-3 py-2 text-sm" href="./genetic-algorithms.html"><span class="w-8">9</span><span class="group-hover:underline">Еволюційне моделювання</span></a></li><li><a class="group relative flex items-center px-3 py-2 text-sm" href="./neural-networks.html"><span class="w-8">10</span><span class="group-hover:underline">Нейронні мережі</span></a></li><li><a class="group relative flex items-center px-3 py-2 text-sm" href="./neuroevolution.html"><span class="w-8">11</span><span class="group-hover:underline">Нейроеволюція</span></a></li><li><a class="relative block px-3 py-2 text-sm hover:underline" href="./appendix-creature.html">Додаток: Дизайн створінь </a></li><li><a class="relative block px-3 py-2 text-sm hover:underline" href="./resources.html">Додаткові ресурси</a></li><li><a class="relative block px-3 py-2 text-sm hover:underline" href="./credits.html">Credits</a></li><li><a class="relative block px-3 py-2 text-sm hover:underline" href="./translation.html">Про переклад</a></li><li><a class="relative block px-3 py-2 text-sm hover:underline" href="./examples.html">Приклади</a></li></ul></nav></aside><main class="prose mx-auto max-w-[50em] pb-8"><section data-type="chapter" id="section-fractals">
<h1 id="chapter-8-fractals">Розділ 8. Фрактали</h1>
<div class="chapter-opening-quote">
  <div class="chapter-opening-quote-long">
    <blockquote data-type="epigraph">
      <p>“Патологічні монстри!” — закричав переляканий математик.</p>
      <p>Кожен із них осколок у моєму оці!</p>
      <p>Я ненавиджу простір Пеано та криву Коха!</p>
      <p>Я боюся тернарну множину Кантора!</p>
      <p>Решітка Серпінського змушує мене плакати!</p>
      <p>А за мільйон миль у стороні метелик змахнув крильцями.</p>
      <p>Холодного листопадового дня народився чоловік, на ім’я Бенуа Мандельброт.</p>
      <div class="chapter-opening-quote-source">
        <p>— Джонатан Коултон, текст із пісні “Множина Мандельброта”</p>
      </div>
    </blockquote>
  </div>
</div>
<div class="chapter-opening-figure">
  <figure>
    <div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:1536px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;864&#x27; width=&#x27;1536&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#d8e8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="./static/55e90da4d9e298cc6cffa4c56d404698/2bb30/08_fractals_1.webp 384w,./static/55e90da4d9e298cc6cffa4c56d404698/c0224/08_fractals_1.webp 768w,./static/55e90da4d9e298cc6cffa4c56d404698/7957e/08_fractals_1.webp 1536w" sizes="(min-width: 1536px) 1536px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 1536px) 1536px, 100vw" decoding="async" loading="lazy" data-src="./static/55e90da4d9e298cc6cffa4c56d404698/8c1d4/08_fractals_1.png" data-srcset="./static/55e90da4d9e298cc6cffa4c56d404698/9f2f3/08_fractals_1.png 384w,./static/55e90da4d9e298cc6cffa4c56d404698/bd088/08_fractals_1.png 768w,./static/55e90da4d9e298cc6cffa4c56d404698/8c1d4/08_fractals_1.png 1536w" alt="Тронний зал Чакрі Маха Прасат, Бангкок, Таїланд (фото Саада Ахтара)"/></picture><noscript><picture><source type="image/webp" srcSet="./static/55e90da4d9e298cc6cffa4c56d404698/2bb30/08_fractals_1.webp 384w,./static/55e90da4d9e298cc6cffa4c56d404698/c0224/08_fractals_1.webp 768w,./static/55e90da4d9e298cc6cffa4c56d404698/7957e/08_fractals_1.webp 1536w" sizes="(min-width: 1536px) 1536px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 1536px) 1536px, 100vw" decoding="async" loading="lazy" src="./static/55e90da4d9e298cc6cffa4c56d404698/8c1d4/08_fractals_1.png" srcSet="./static/55e90da4d9e298cc6cffa4c56d404698/9f2f3/08_fractals_1.png 384w,./static/55e90da4d9e298cc6cffa4c56d404698/bd088/08_fractals_1.png 768w,./static/55e90da4d9e298cc6cffa4c56d404698/8c1d4/08_fractals_1.png 1536w" alt="Тронний зал Чакрі Маха Прасат, Бангкок, Таїланд (фото Саада Ахтара)"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div>
    <figcaption></figcaption>
  </figure>
  <span id="chakri-maha-prasat-hall-bangkok-thailand-photo-by-saad-akhtar"><a class="heading-link" href="#chakri-maha-prasat-hall-bangkok-thailand-photo-by-saad-akhtar">Тронний зал Чакрі Маха Прасат, Бангкок, Таїланд (фото Саада Ахтара)</a></span>
  <p>Зал Чакрі Маха Прасат, розташований у Великому палаці у центрі Бангкока, Таїланд, і є архітектурним досягненням, відомим своїми складними деталями та величчю. Кожен рівень багатошарового даху повторює меншу чи більшу версію самого себе та представляє різні рівні гори Меру, центру буддійського всесвіту.</p>
<hr/></div>
<p></p>
<p>Колись у середній школі я вивчав курс геометрії. Можливо, ви теж пр ойшли такий курс, де дізналися про класичні форми в одному, двох і, можливо, навіть у трьох вимірах. Яка довжина кола? Площа прямокутника? Відстань між точкою і прямою лінією? Такий вид геометрії зазвичай називають <strong>евклідовою геометрією</strong>, на честь грецького математика Евкліда і, якщо подумати, це тема, яку я весь час розглядав у цій книзі. Щоразу, коли я використовував вектори для опису руху тіл у декартовому просторі, це була евклідова геометрія.</p>
<p>Однак для нас, програмістів природи, я хотів би поставити питання: чи <em>справді</em> наш світ можна описати за допомогою евклідової геометрії? Екран ноутбука, на який я зараз дивлюся, напевно виглядає як прямокутник. А слива, яку я їв сьогодні вранці, була кулястою. Але що, якби я подивився далі й подумав про дерева, що обсаджують вулицю, листя, що звисає з цих дерев, блискавку вчорашньої грози, цвітну капусту, яку я з’їв на вечерю, кровоносні судини в моєму тілі, гори та берегові лінії, що визначають ландшафт? Як показано на малюнку 8.1, більшість речей, які ви зустрінете у природі, виглядають зовсім не так, як ідеалізовані геометричні форми евклідової геометрі ї.</p>
<figure>
  <div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:2304px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;651&#x27; width=&#x27;2304&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="./static/8fb474fbf04f5b99ea64f3155fa66f57/d0a2a/08_fractals_2.webp 576w,./static/8fb474fbf04f5b99ea64f3155fa66f57/51f6e/08_fractals_2.webp 1152w,./static/8fb474fbf04f5b99ea64f3155fa66f57/fed0c/08_fractals_2.webp 2304w" sizes="(min-width: 2304px) 2304px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2304px) 2304px, 100vw" decoding="async" loading="lazy" data-src="./static/8fb474fbf04f5b99ea64f3155fa66f57/32369/08_fractals_2.png" data-srcset="./static/8fb474fbf04f5b99ea64f3155fa66f57/94409/08_fractals_2.png 576w,./static/8fb474fbf04f5b99ea64f3155fa66f57/282ef/08_fractals_2.png 1152w,./static/8fb474fbf04f5b99ea64f3155fa66f57/32369/08_fractals_2.png 2304w" alt="Малюнок 8.1: Порівняння ідеалізованої евклідової геометрії з формами, що зустрічаються у природі"/></picture><noscript><picture><source type="image/webp" srcSet="./static/8fb474fbf04f5b99ea64f3155fa66f57/d0a2a/08_fractals_2.webp 576w,./static/8fb474fbf04f5b99ea64f3155fa66f57/51f6e/08_fractals_2.webp 1152w,./static/8fb474fbf04f5b99ea64f3155fa66f57/fed0c/08_fractals_2.webp 2304w" sizes="(min-width: 2304px) 2304px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2304px) 2304px, 100vw" decoding="async" loading="lazy" src="./static/8fb474fbf04f5b99ea64f3155fa66f57/32369/08_fractals_2.png" srcSet="./static/8fb474fbf04f5b99ea64f3155fa66f57/94409/08_fractals_2.png 576w,./static/8fb474fbf04f5b99ea64f3155fa66f57/282ef/08_fractals_2.png 1152w,./static/8fb474fbf04f5b99ea64f3155fa66f57/32369/08_fractals_2.png 2304w" alt="Малюнок 8.1: Порівняння ідеалізованої евклідової геометрії з формами, що зустрічаються у природі"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div>
  <figcaption>Малюнок 8.1: Порівняння ідеалізованої евклідової геометрії з формами, що зустрічаються у природі</figcaption>
</figure>
<p>Якщо ви хочете розпочати створення програмних проєктів із патернами, які виходять за межі базових форм, таких як <code>circle()</code>, <code>square()</code> і <code>line()</code>, настав час дізнатися про інший тип геометрії, <em>геометрію природи</em>: фрактали. У цьому розділі розглядаються концепції фракталів, а також методи програмування для моделювання фрактальної геометрії.</p>
<h2 id="what-is-a-fractal"><a class="heading-link" href="#what-is-a-fractal">Що таке фрактал?</a></h2>
<p>Термін <strong>фрактал</strong> (від латинського <em>fractus</em>, що означає “поламаний”) був введений математиком Бенуа Мандельбротом у 1975 році. У його основоположній праці “<em>Фрактальна геометрія природи</em>” він визначає фрактал як “грубу або фрагментовану геометричну форму, яку можна розділити на частини, кожна з яких є (принаймні приблизно) зменшеною копією цілого”.</p>
<p>Я проілюструю це визначення двома простими прикладами. Спочатку подумайте про розгалужену структуру дерева, як показано на малюнку 8.2. (У прикладі 8.6 я покажу вам, як написати код для малювання цього дерева.)</p>
<figure>
  <div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:1152px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;521&#x27; width=&#x27;1152&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="./static/0b75f02f215c51acc9f9f608093c8bfa/236fb/08_fractals_3.webp 288w,./static/0b75f02f215c51acc9f9f608093c8bfa/e9966/08_fractals_3.webp 576w,./static/0b75f02f215c51acc9f9f608093c8bfa/f4999/08_fractals_3.webp 1152w" sizes="(min-width: 1152px) 1152px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 1152px) 1152px, 100vw" decoding="async" loading="lazy" data-src="./static/0b75f02f215c51acc9f9f608093c8bfa/8c635/08_fractals_3.png" data-srcset="./static/0b75f02f215c51acc9f9f608093c8bfa/4208a/08_fractals_3.png 288w,./static/0b75f02f215c51acc9f9f608093c8bfa/5128f/08_fractals_3.png 576w,./static/0b75f02f215c51acc9f9f608093c8bfa/8c635/08_fractals_3.png 1152w" alt="Малюнок 8.2: Розгалужене фрактальне дерево"/></picture><noscript><picture><source type="image/webp" srcSet="./static/0b75f02f215c51acc9f9f608093c8bfa/236fb/08_fractals_3.webp 288w,./static/0b75f02f215c51acc9f9f608093c8bfa/e9966/08_fractals_3.webp 576w,./static/0b75f02f215c51acc9f9f608093c8bfa/f4999/08_fractals_3.webp 1152w" sizes="(min-width: 1152px) 1152px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 1152px) 1152px, 100vw" decoding="async" loading="lazy" src="./static/0b75f02f215c51acc9f9f608093c8bfa/8c635/08_fractals_3.png" srcSet="./static/0b75f02f215c51acc9f9f608093c8bfa/4208a/08_fractals_3.png 288w,./static/0b75f02f215c51acc9f9f608093c8bfa/5128f/08_fractals_3.png 576w,./static/0b75f02f215c51acc9f9f608093c8bfa/8c635/08_fractals_3.png 1152w" alt="Малюнок 8.2: Розгалужене фрактальне дерево"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div>
  <figcaption>Малюнок 8.2: Розгалужене фрактальне дерево</figcaption>
</figure>
<p>Зверніть увагу, що дерево має один стовбур із з’єднаними на кінці гілками. Кожна з цих гілок також має гілки на своєму кінці, а ці гілки також мають гілки й так далі. А що, якби ви зірвали одну гілку з цього дерева й уважніше оглянули її, як на малюнку 8.3?</p>
<figure>
  <div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:1152px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;518&#x27; width=&#x27;1152&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="./static/5f27f3bb8139f9ffeea11c9302a77483/236fb/08_fractals_4.webp 288w,./static/5f27f3bb8139f9ffeea11c9302a77483/36501/08_fractals_4.webp 576w,./static/5f27f3bb8139f9ffeea11c9302a77483/34be3/08_fractals_4.webp 1152w" sizes="(min-width: 1152px) 1152px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 1152px) 1152px, 100vw" decoding="async" loading="lazy" data-src="./static/5f27f3bb8139f9ffeea11c9302a77483/8cb8e/08_fractals_4.png" data-srcset="./static/5f27f3bb8139f9ffeea11c9302a77483/4208a/08_fractals_4.png 288w,./static/5f27f3bb8139f9ffeea11c9302a77483/23528/08_fractals_4.png 576w,./static/5f27f3bb8139f9ffeea11c9302a77483/8cb8e/08_fractals_4.png 1152w" alt="Малюнок 8.3: Збільшений вигляд однієї гілки фрактального дерева"/></picture><noscript><picture><source type="image/webp" srcSet="./static/5f27f3bb8139f9ffeea11c9302a77483/236fb/08_fractals_4.webp 288w,./static/5f27f3bb8139f9ffeea11c9302a77483/36501/08_fractals_4.webp 576w,./static/5f27f3bb8139f9ffeea11c9302a77483/34be3/08_fractals_4.webp 1152w" sizes="(min-width: 1152px) 1152px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 1152px) 1152px, 100vw" decoding="async" loading="lazy" src="./static/5f27f3bb8139f9ffeea11c9302a77483/8cb8e/08_fractals_4.png" srcSet="./static/5f27f3bb8139f9ffeea11c9302a77483/4208a/08_fractals_4.png 288w,./static/5f27f3bb8139f9ffeea11c9302a77483/23528/08_fractals_4.png 576w,./static/5f27f3bb8139f9ffeea11c9302a77483/8cb8e/08_fractals_4.png 1152w" alt="Малюнок 8.3: Збільшений вигляд однієї гілки фрактального дерева"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div>
  <figcaption>Малюнок 8.3: Збільшений вигляд однієї гілки фрактального дерева</figcaption>
</figure>
<p>Збільшена гілка є точною копією цілого, як описує Мандельброт. Однак не всі фрактали повинні бути ідеально самоподібними, як це дерево. Наприклад, подивіться на малюнок 8.4, на якому показано дві ілюстра ції узбережжя Гренландії (або Kalaallit Nunaat мовою корінного населення Kalaallisut).</p>
<figure>
  <div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:2304px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;836&#x27; width=&#x27;2304&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="./static/b43a6a7cbe5216c8765e0a1ba3dbf1c5/e79c8/08_fractals_5.webp 576w,./static/b43a6a7cbe5216c8765e0a1ba3dbf1c5/d9c29/08_fractals_5.webp 1152w,./static/b43a6a7cbe5216c8765e0a1ba3dbf1c5/aa9ee/08_fractals_5.webp 2304w" sizes="(min-width: 2304px) 2304px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2304px) 2304px, 100vw" decoding="async" loading="lazy" data-src="./static/b43a6a7cbe5216c8765e0a1ba3dbf1c5/4cd5b/08_fractals_5.png" data-srcset="./static/b43a6a7cbe5216c8765e0a1ba3dbf1c5/a6c99/08_fractals_5.png 576w,./static/b43a6a7cbe5216c8765e0a1ba3dbf1c5/2f02c/08_fractals_5.png 1152w,./static/b43a6a7cbe5216c8765e0a1ba3dbf1c5/4cd5b/08_fractals_5.png 2304w" alt="Малюнок 8.4: Дві берегові лінії"/></picture><noscript><picture><source type="image/webp" srcSet="./static/b43a6a7cbe5216c8765e0a1ba3dbf1c5/e79c8/08_fractals_5.webp 576w,./static/b43a6a7cbe5216c8765e0a1ba3dbf1c5/d9c29/08_fractals_5.webp 1152w,./static/b43a6a7cbe5216c8765e0a1ba3dbf1c5/aa9ee/08_fractals_5.webp 2304w" sizes="(min-width: 2304px) 2304px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2304px) 2304px, 100vw" decoding="async" loading="lazy" src="./static/b43a6a7cbe5216c8765e0a1ba3dbf1c5/4cd5b/08_fractals_5.png" srcSet="./static/b43a6a7cbe5216c8765e0a1ba3dbf1c5/a6c99/08_fractals_5.png 576w,./static/b43a6a7cbe5216c8765e0a1ba3dbf1c5/2f02c/08_fractals_5.png 1152w,./static/b43a6a7cbe5216c8765e0a1ba3dbf1c5/4cd5b/08_fractals_5.png 2304w" alt="Малюнок 8.4: Дві берегові лінії"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div>
  <figcaption>Малюнок 8.4: Дві берегові лінії</figcaption>
</figure>
<p>Відсутність масштабу на цих ілюстраціях не випадкова. Я тут показую всю берегову лінію чи лише її невелику частину? Без посилання на масштаб про це неможливо дізнатися, тому що берегові лінії, подібно фракталам, виглядають практично однаково у будь-якому масштабі. (До речі, берегова лінія B показує приблизно в 3 рази збільшене зображення конкретної ділянки берегової лінії A. Я додав масштаб на малюнку 8.5.)</p>
<figure>
  <div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:2304px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;1041&#x27; width=&#x27;2304&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="./static/97641a7c3b8bfe5017e7356323d2cad4/3af8f/08_fractals_6.webp 576w,./static/97641a7c3b8bfe5017e7356323d2cad4/f4999/08_fractals_6.webp 1152w,./static/97641a7c3b8bfe5017e7356323d2cad4/f2af9/08_fractals_6.webp 2304w" sizes="(min-width: 2304px) 2304px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2304px) 2304px, 100vw" decoding="async" loading="lazy" data-src="./static/97641a7c3b8bfe5017e7356323d2cad4/e9174/08_fractals_6.png" data-srcset="./static/97641a7c3b8bfe5017e7356323d2cad4/0a313/08_fractals_6.png 576w,./static/97641a7c3b8bfe5017e7356323d2cad4/8c635/08_fractals_6.png 1152w,./static/97641a7c3b8bfe5017e7356323d2cad4/e9174/08_fractals_6.png 2304w" alt="Малюнок 8.5: Дві берегові лінії з їх масштабом"/></picture><noscript><picture><source type="image/webp" srcSet="./static/97641a7c3b8bfe5017e7356323d2cad4/3af8f/08_fractals_6.webp 576w,./static/97641a7c3b8bfe5017e7356323d2cad4/f4999/08_fractals_6.webp 1152w,./static/97641a7c3b8bfe5017e7356323d2cad4/f2af9/08_fractals_6.webp 2304w" sizes="(min-width: 2304px) 2304px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2304px) 2304px, 100vw" decoding="async" loading="lazy" src="./static/97641a7c3b8bfe5017e7356323d2cad4/e9174/08_fractals_6.png" srcSet="./static/97641a7c3b8bfe5017e7356323d2cad4/0a313/08_fractals_6.png 576w,./static/97641a7c3b8bfe5017e7356323d2cad4/8c635/08_fractals_6.png 1152w,./static/97641a7c3b8bfe5017e7356323d2cad4/e9174/08_fractals_6.png 2304w" alt="Малюнок 8.5: Дві бере гові лінії з їх масштабом"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div>
  <figcaption>Малюнок 8.5: Дві берегові лінії з підписаним масштабом</figcaption>
</figure>
<p>Берегова лінія є прикладом <strong>стохастичного</strong> фракталу, тобто вона побудована на основі ймовірностей і випадковості. На відміну від <strong>детермінованої</strong> (або передбачуваної) деревоподібної структури, стохастичний фрактал є <em>статистично</em> самоподібним. Це означає, що навіть якщо візерунок не є абсолютно однаковим для кожної частини меншого розміру, загальна якість форми та її загальне сприйняття залишаються незмінними незалежно від того, наскільки ви збільшуєте чи зменшуєте масштаб. Приклади в цьому розділі досліджують як детерміновані, так і стохастичні методи генерації фрактальних візерунків.</p>
<p>Хоча самоподібність є ключовою рисою фракталів, важливо розуміти, що сама по собі подібність не визначає фрактал. Зрештою, пряма лінія є самоподібною: вона виглядає однаково в будь-якому масштабі і її можна вважати такою, що складається з безлічі маленьких ліній. Але пряма лінія не є фракталом. Фрактали характеризуються тонкою структурою в малих масштабах (продовжуйте наближати берегову лінію, і ви продовжите знаходити флуктуації), і їх не можна описати за допомогою евклідової геометрії. Як правило, якщо ви можете сказати що “Це лінія!” тоді це не фрактал.</p>
<div data-type="note" class="callout">
  <h3 id="the-mandelbrot-set"><a class="heading-link" href="#the-mandelbrot-set">Множина Мандельброта</a></h3>
  <p>Один із найвідоміших і впізнаваних фрактальних візерунків названий на честь самого Мандельброта. Створення <strong>множини Мандельброта</strong> передбачає дослідження властивостей комплексних чисел після їх проходження через ітераційну функцію. Чи тяжіють вони до нескінченності? Чи залишаються обмеженими?</p>
  <p>Попри захопливе математичне обговорення, цей алгоритм є менш практичним способом генерації фракталів, ніж рекурсивні способи, які ми розглянемо в цьому розділі. У будь-якому випадку код для створення множини Мандельброта включено в онлайн-приклади.</p>
  <figure>
    <div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:1800px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;430.99999999999994&#x27; width=&#x27;1800&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#080808;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="./static/92e3c7046b9d124dc484ad9f6367a3c7/161ed/08_fractals_7.webp 450w,./static/92e3c7046b9d124dc484ad9f6367a3c7/a62c3/08_fractals_7.webp 900w,./static/92e3c7046b9d124dc484ad9f6367a3c7/7f7a7/08_fractals_7.webp 1800w" sizes="(min-width: 1800px) 1800px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 1800px) 1800px, 100vw" decoding="async" loading="lazy" data-src="./static/92e3c7046b9d124dc484ad9f6367a3c7/4dcd6/08_fractals_7.png" data-srcset="./static/92e3c7046b9d124dc484ad9f6367a3c7/5dab3/08_fractals_7.png 450w,./static/92e3c7046b9d124dc484ad9f6367a3c7/343d6/08_fractals_7.png 900w,./static/92e3c7046b9d124dc484ad9f6367a3c7/4dcd6/08_fractals_7.png 1800w" alt=""/></picture><noscript><picture><source type="image/webp" srcSet="./static/92e3c7046b9d124dc484ad9f6367a3c7/161ed/08_fractals_7.webp 450w,./static/92e3c7046b9d124dc484ad9f6367a3c7/a62c3/08_fractals_7.webp 900w,./static/92e3c7046b9d124dc484ad9f6367a3c7/7f7a7/08_fractals_7.webp 1800w" sizes="(min-width: 1800px) 1800px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 1800px) 1800px, 100vw" decoding="async" loading="lazy" src="./static/92e3c7046b9d124dc484ad9f6367a3c7/4dcd6/08_fractals_7.png" srcSet="./static/92e3c7046b9d124dc484ad9f6367a3c7/5dab3/08_fractals_7.png 450w,./static/92e3c7046b9d124dc484ad9f6367a3c7/343d6/08_fractals_7.png 900w,./static/92e3c7046b9d124dc484ad9f6367a3c7/4dcd6/08_fractals_7.png 1800w" alt=""/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div>
    <figcaption></figcaption>
  </figure>
</div>
<p>Фрактали ведуть довгу історію ще до книги Мандельброта 1975 року, з’являючись у різних формах у різних культурах. Вони практично такі ж старі, як сама природа. Корінні та стародавні суспільства часто включали фрактальні візерунки у своє мистецтво, архітектуру та текстиль задовго до офіційного вивчення фракталів у західній математиці. Наприклад, традиційне планування села Ба-Іла в Замбії та складні геометричні візерунки в ісламській архітектурі демонструють фрактальні властивості. Ці візерунки підкреслюють важливість фракталів у різноманітних культурних контекстах та їхню позачасов у привабливість.</p>
<h2 id="recursion"><a class="heading-link" href="#recursion">Рекурсія</a></h2>
<p>Окрім самоподібності, іншим фундаментальним компонентом фрактальної геометрії є <strong>рекурсія</strong>: процес багаторазового застосування правила, відомого як <strong>породжувальне правило</strong>, яке вказує на те, що результат однієї ітерації стає відправною точкою для наступної. Рекурсія з’явилася у полі зору з першої появи фракталів у сучасній математиці, коли німецький математик Георг Кантор у 1883 році розробив прості правила генерування нескінченного набору чисел. Правила породжувального правила Кантора проілюстровано на малюнку 8.6.</p>
<figure>
  <div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:2304px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;558&#x27; width=&#x27;2304&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="./static/c03cc2d09e9aedd6d1c6b57496e9f622/aa90c/08_fractals_8.webp 576w,./static/c03cc2d09e9aedd6d1c6b57496e9f622/4eeeb/08_fractals_8.webp 1152w,./static/c03cc2d09e9aedd6d1c6b57496e9f622/46c79/08_fractals_8.webp 2304w" sizes="(min-width: 2304px) 2304px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2304px) 2304px, 100vw" decoding="async" loading="lazy" data-src="./static/c03cc2d09e9aedd6d1c6b57496e9f622/3b439/08_fractals_8.png" data-srcset="./static/c03cc2d09e9aedd6d1c6b57496e9f622/47abc/08_fractals_8.png 576w,./static/c03cc2d09e9aedd6d1c6b57496e9f622/a2484/08_fractals_8.png 1152w,./static/c03cc2d09e9aedd6d1c6b57496e9f622/3b439/08_fractals_8.png 2304w" alt="Малюнок 8.6: Інструкції рекурсії для генерації фракталу множини Кантора"/></picture><noscript><picture><source type="image/webp" srcSet="./static/c03cc2d09e9aedd6d1c6b57496e9f622/aa90c/08_fractals_8.webp 576w,./static/c03cc2d09e9aedd6d1c6b57496e9f622/4eeeb/08_fractals_8.webp 1152w,./static/c03cc2d09e9aedd6d1c6b57496e9f622/46c79/08_fractals_8.webp 2304w" sizes="(min-width: 2304px) 2304px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2304px) 2304px, 100vw" decoding="async" loading="lazy" src="./static/c03cc2d09e9aedd6d1c6b57496e9f622/3b439/08_fractals_8.png" srcSet="./static/c03cc2d09e9aedd6d1c6b57496e9f622/47abc/08_fractals_8.png 576w,./static/c03cc2d09e9aedd6d1c6b57496e9f622/a2484/08_fractals_8.png 1152w,./static/c03cc2d09e9aedd6d1c6b57496e9f622/3b439/08_fractals_8.png 2304w" alt="Малюнок 8.6: Інструкції рекурсії для генерації фракталу множини Кантора"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div>
  <figcaption>Малюнок 8.6: Інструкції рекурсії для генерації фракталу множини Кантора</figcaption>
</figure>
<p>У правилах Кантора діє цикл зворотного зв’язку. Візьміть одну лінію і розділіть її на дві. Потім поверніться до цих двох ліній і застосуйте те саме правило, розділяючи кожну лінію на дві. Тепер їх чотири. Поверніться до цих чотирьох ліній і застосуйте до них правило. Тепер їх вісім. І так далі. Ось як працює рекурсія: вихідні дані процесу повертаються у сам процес знову і знову. У цьому випадку результат відомий як <strong>множина Кантора</strong>. Подібно до фрактального дерева на малюнку 8.3, це приклад детермінованого, цілком передбачуваного фракталу, у якому кожна частина є точною копією цілого.</p>
<p>Кантора цікавило, що станеться, якщо застосувати рекурсивний набір правил нескінченну кількість разів. Однак ми з вами не маємо нескінченного часу. Крім того, програма p5.js обмежена доступним простором пікселів, тому в якийсь момент стає неможливо намалювати все менші лінії. Таким чином, для цілей цієї книги я здебільшого ігноруватиму питання та парадокси, які виникають унаслідок нескінченної рекурсії. Натомість код буде побудовано таким чином, де правила не застосовуються “вічно” (що призвело б до нескінченного циклу та зависання комп’ютера), а натомість припиняються, коли виконується певна умова.</p>
<h3 id="implementing-recursive-functions"><a class="heading-link" href="#implementing-recursive-functions">Реалізація рекурсивних функцій</a></h3>
<p>За мить я напишу програму, яка рекурсивно реалізує набір Кантора. Але спочатку розберемося, що значить мати рекурсію в коді? Все зводиться до виклику функції зсередини функції. Це, само по собі, не є чимось новим. Зрештою, ймовірно, ви весь час викликаєте функції з інших функцій. Наприклад:</p>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">someFunction</span>(<span class="hljs-params"></span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">background</span>(<span class="hljs-number">0</span>);
</code></pre><div class="comment"><p>Виклик функції background() у функції someFunction().</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">}
</code></pre><div class="comment"><p></p></div></div></div>
<p>Ключова відмінність рекурсії полягає у виклику функції, яку ви описуєте, у цій самій функції. Що станеться в такому випадку? Чи можна функцію <code>someFunction()</code> викликати всередині <code>someFunction()</code>?</p>
<div class="avoid-break">
  <div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">someFunction</span>(<span class="hljs-params"></span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">someFunction</span>();
</code></pre><div class="comment"><p>Це парадокс?</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">}
</code></pre><div class="comment"><p></p></div></div></div>
</div>
<p>Це не тільки дозволено, але і заохочується! Насправді це важливо для того, як я буду реалізовувати множину Кантора. Функції, які викликають самі себе, називають <strong>рекурсивними функціями</strong> й вони добре підходять для розв&#x27;язання певних проблем. Наприклад, деякі математичні обчислення реалізуються рекурсивно: найвідомішим прикладом є <strong>факторіал</strong>.</p>
<p>Факторіал будь-якого числа <em>n</em>, зазвичай записується як <em>n!</em>, визначається наступним чином:</p>
<div data-type="equation" class="math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>n</mi><mo stretchy="false">!</mo><mo>=</mo><mi>n</mi><mo>×</mo><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>×</mo><mo>…</mo><mo>×</mo><mn>3</mn><mo>×</mo><mn>2</mn><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n! = n × (n - 1) × … × 3 × 2 × 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">n</span><span class="mclose">!</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span></span></div>
<div data-type="equation" class="math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mn>0</mn><mo stretchy="false">!</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0! = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord">0</span><span class="mclose">!</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span></span></div>
<p>Ось нерекурсивна функція в JavaScript, яка використовує цикл <code>for</code> для обчислення факторіала числа:</p>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">factorial</span>(<span class="hljs-params">n</span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">let</span> value = <span class="hljs-number">1</span>;
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) {
    value = value * (i + <span class="hljs-number">1</span>);
  }
</code></pre><div class="comment"><p>Використання звичайного циклу для обчислення факторіалу.</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">return</span> value;
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">}
</code></pre><div class="comment"><p></p></div></div></div>
<p>При уважному розгляді ви помітите щось цікаве про те, як працюють факторіали. Подумайте, як визначаються 4! і 3!:</p>
<div data-type="equation" class="math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mn>4</mn><mo stretchy="false">!</mo><mo>=</mo><mn>4</mn><mo>×</mo><mn>3</mn><mo>×</mo><mn>2</mn><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">4! = 4 \times 3 \times 2 \times 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord">4</span><span class="mclose">!</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span></span></div>
<div data-type="equation" class="math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mn>3</mn><mo stretchy="false">!</mo><mo>=</mo><mn>3</mn><mo>×</mo><mn>2</mn><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">3! = 3 \times 2 \times 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord">3</span><span class="mclose">!</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span></span></div>
<p>Повне визначення 3! міститься у визначенні 4!:</p>
<div data-type="equation" class="math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mn>4</mn><mo stretchy="false">!</mo><mo>=</mo><mn>4</mn><mo>×</mo><mn>3</mn><mo stretchy="false">!</mo></mrow><annotation encoding="application/x-tex">4! = 4 \times 3!</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord">4</span><span class="mclose">!</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord">3</span><span class="mclose">!</span></span></span></span></span></div>
<p>У більш загальному вигляді для будь-якого натурального числа <em>n</em>, вірно наступне:</p>
<div data-type="equation" class="math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>n</mi><mo stretchy="false">!</mo><mo>=</mo><mi>n</mi><mo>×</mo><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">!</mo></mrow><annotation encoding="application/x-tex">n! = n \times (n-1)!</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">n</span><span class="mclose">!</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">1</span><span class="mclose">)!</span></span></span></span></span></div>
<div data-type="equation" class="math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mn>0</mn><mo stretchy="false">!</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0! = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord">0</span><span class="mclose">!</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span></span></div>
<p>Записуючи це, я можу сказати, що <em>факторіал</em> числа <em>n</em> визначається як число <em>n</em> помножене на <em>факторіал</em> числа <em>n – 1</em>.</p>
<p>Визначення <em>факторіала</em> включає <em>факторіал</em>? Це схоже на визначення <em>піци</em> як “смачної їжі, яка містить шматочки піци”. Хоча це визначення піци, безперечно, безглузде, воно підкреслює концепцію самопосилання у визначенні та є суттю рекурсії. Застосовуючи його до визначення функції в коді це може призвести до надзвичайно елегантних рішень, таких як це рекурсивне визначення функції <code>factorial()</code>:</p>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">factorial</span>(<span class="hljs-params">n</span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">if</span> (n &lt;= <span class="hljs-number">1</span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  } <span class="hljs-keyword">else</span> {
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">    <span class="hljs-keyword">return</span> n * <span class="hljs-title function_">factorial</span>(n - <span class="hljs-number">1</span>);
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  }
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">}
</code></pre><div class="comment"><p></p></div></div></div>
<p>Функція <code>factorial()</code> викликає сама с ебе у своєму власному визначенні. Спочатку це може виглядати трохи дивно, але воно працює, доки існує умова зупинки (у цьому випадку <code>n &lt;= 1</code>), тому функція не зависає, викликаючи саму себе нескінченно. (Я використовую <code>&lt;=</code> замість <code>===</code>, щоб запобігти нескінченній рекурсії, але мені, ймовірно, слід включити додаткові перевірки помилок, щоб керувати нецілими або від’ємними вхідними даними й бути більш математично точним.) Малюнок 8.7 ілюструє кроки, які розгортаються під час виклику <code>factorial(4)</code>.</p>
<figure>
  <div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:2304px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;1502&#x27; width=&#x27;2304&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="./static/f4778e02fc520edd7204a8318d3b5a54/68646/08_fractals_9.webp 576w,./static/f4778e02fc520edd7204a8318d3b5a54/4a079/08_fractals_9.webp 1152w,./static/f4778e02fc520edd7204a8318d3b5a54/84dff/08_fractals_9.webp 2304w" sizes="(min-width: 2304px) 2304px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2304px) 2304px, 100vw" decoding="async" loading="lazy" data-src="./static/f4778e02fc520edd7204a8318d3b5a54/34f16/08_fractals_9.png" data-srcset="./static/f4778e02fc520edd7204a8318d3b5a54/7c7d4/08_fractals_9.png 576w,./static/f4778e02fc520edd7204a8318d3b5a54/a3eea/08_fractals_9.png 1152w,./static/f4778e02fc520edd7204a8318d3b5a54/34f16/08_fractals_9.png 2304w" alt="Малюнок 8.7: Візуалізація процесу виклику рекурсивної функції factorial()"/></picture><noscript><picture><source type="image/webp" srcSet="./static/f4778e02fc520edd7204a8318d3b5a54/68646/08_fractals_9.webp 576w,./static/f4778e02fc520edd7204a8318d3b5a54/4a079/08_fractals_9.webp 1152w,./static/f4778e02fc520edd7204a8318d3b5a54/84dff/08_fractals_9.webp 2304w" sizes="(min-width: 2304px) 2304px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2304px) 2304px, 100vw" decoding="async" loading="lazy" src="./static/f4778e02fc520edd7204a8318d3b5a54/34f16/08_fractals_9.png" srcSet="./static/f4778e02fc520edd7204a8318d3b5a54/7c7d4/08_fractals_9.png 576w,./static/f4778e02fc520edd7204a8318d3b5a54/a3eea/08_fractals_9.png 1152w,./static/f4778e02fc520edd7204a8318d3b5a54/34f16/08_fractals_9.png 2304w" alt="Малюнок 8.7: Візуалізація процесу виклику рекурсивної функції factorial()"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div>
  <figcaption>Малюнок 8.7: Візуалізація процесу виклику рекурсивної функції <code>factorial()</code></figcaption>
</figure>
<p>Функція продовжує викликати саму себе, спускаючись все глибше і глибше в кролячу нору вкладених викликів функцій, доки не досягне умови зупинки. Потім вона виходить із діри, повертаючи значення, доки не повернеться додому до початкового виклику <code>factorial(4)</code>.</p>
<p>Ви можете застосувати той самий рекурсивний принцип, який ілюструє функція <code>factorial()</code> до графіки на полотні, тільки замість повернення значень ви малюватимете фігури. Це саме те, що ви побачите в прикладах цього розділу. Для початку, ось проста рекурсивна функція, яка малює дедалі менші кола.</p>
<div data-type="example">
  <h3 id="example-81-recursive-circles-once"><a class="heading-link" href="#example-81-recursive-circles-once">Приклад 8.1: Рекурсивні кільця</a></h3>
  <figure>
    <div class="not-prose clear-both my-4 overflow-hidden rounded border bg-gray-100" style="max-width:1152px"><div class="relative overflow-hidden rounded-t bg-white"><!-- <div class="absolute left-[50%] top-[50%] -translate-x-[50%] -translate-y-[50%] ">Loading sketch ...</div> --><iframe class="w-full border-none transition-opacity opacity-1000" style="aspect-ratio:2.667" loading="lazy" src="./examples/08_fractals/8_1_recursion"></iframe></div><div class="flex items-center justify-between border-t"><div class="flex"><button class="flex items-center border-r px-2.5 py-1.5 text-sm hover:bg-gray-200"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true" class="h-[15px] w-[15px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg><span class="ml-1.5">Reset</span></button><button class="flex items-center border-r px-2.5 py-1.5 text-sm hover:bg-gray-200"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span class="ml-1">Pause</span></button></div><a href="https://editor.p5js.org/natureofcode/sketches/yqMKM_1NS" target="_blank" rel="noreferrer" class="flex items-center px-2.5 text-[0.8rem] hover:underline">Open in Web Editor<svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="ml-1 text-gray-500" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></a></div></div>
    <figcaption></figcaption>
  </figure>
</div>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">drawCircles</span>(<span class="hljs-params">x, y, r</span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">circle</span>(x, y, r * <span class="hljs-number">2</span>);
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">if</span> (r &gt; <span class="hljs-number">4</span>) {
</code></pre><div class="comment"><p>Умова виходу: зупинитися, коли радіус занадто малий.</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">    r *= <span class="hljs-number">0.75</span>;
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">    <span class="hljs-title function_">drawCircles</span>(x, y, r);
</code></pre><div class="comment"><p>Виклик функції всередині самої себе — рекурсія!</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  }
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">}
</code></pre><div class="comment"><p></p></div></div></div>
<p>Функція <code>drawCircles()</code> малює коло на основі набору параметрів, які вона отримує як аргументи. Потім вона викликає сама себе з тими самими параметрами, дещо змінюючи їх. У результаті виходить серія кілець, кожне з яких намальовано всередині попереднього.</p>
<p>Подібно до того, як функція <code>factorial()</code> припиняє рекурсію, коли <code>n</code> дорівнює <code>0</code>, функція <code>drawCircles()</code> рекурсивно викликає саму себе, лише якщо радіус більший за <code>4</code>. Це важливий момент. Як і у випадку з ітерацією, <em>усі рекурсивні функції повинні мати умову виходу</em>! Ви, мабуть, уже знаєте, що цикли <code>for</code> і <code>while</code> повинні включати логічний вираз, який зрештою вираховується як <code>false</code>, таким чином виходячи з циклу. Без нього програма потрапила б у нескінченний цикл. Те саме можна сказати й про рекурсію. Якщо рекурсивна функція викликає сама себе постійно без виходу, у більшості випадків ви отримаєте непривітний, завмерлий екран. Однак браузер має вбудовані засоби захисту, і замість того, щоб остаточно зависнути, він закриває програму із повідомленням про помилку <code>Maximum call stack size exceeded</code>. Це просто популярний спосіб сказати: “Забагато рекурсивних викликів однієї функції, час зупинитися!”</p>
<p>Приклад 8.1 був досить тривіальним, цього можна легко досягти простою ітерацією за допомогою циклу <code>for</code> або <code>while</code>. Однак результати стають цікавішими, коли функція визначена із викликом самої себе більше одного разу. У таких сценаріях рекурсія стає надзвичайно елегантною. Для ілюстрації я зроблю функцію <code>drawCircles()</code> складнішою. Для кожного кола, що зображається, ми намалюємо всередині ще два кола, удвічі меншого розміру: одне ліворуч від центру, а інше — праворуч.</p>
<div data-type="example">
  <h3 id="example-82-recursive-circles-twice"><a class="heading-link" href="#example-82-recursive-circles-twice">Приклад 8.2: Подвійні рекурсивні кільця</a></h3>
  <figure>
    <div class="not-prose clear-both my-4 overflow-hidden rounded border bg-gray-100" style="max-width:1152px"><div class="relative overflow-hidden rounded-t bg-white"><!-- <div class="absolute left-[50%] top-[50%] -translate-x-[50%] -translate-y-[50%] ">Loading sketch ...</div> --><iframe class="w-full border-none transition-opacity opacity-1000" style="aspect-ratio:2.667" loading="lazy" src="./examples/08_fractals/8_2_recursion"></iframe></div><div class="flex items-center justify-between border-t"><div class="flex"><button class="flex items-center border-r px-2.5 py-1.5 text-sm hover:bg-gray-200"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true" class="h-[15px] w-[15px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg><span class="ml-1.5">Reset</span></button><button class="flex items-center border-r px-2.5 py-1.5 text-sm hover:bg-gray-200"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span class="ml-1">Pause</span></button></div><a href="https://editor.p5js.org/natureofcode/sketches/0ENwBr7Idw" target="_blank" rel="noreferrer" class="flex items-center px-2.5 text-[0.8rem] hover:underline">Open in Web Editor<svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="ml-1 text-gray-500" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></a></div></div>
    <figcaption></figcaption>
  </figure>
</div>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">createCanvas</span>(<span class="hljs-number">640</span>, <span class="hljs-number">240</span>);
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">}
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">draw</span>(<span class="hljs-params"></span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">background</span>(<span class="hljs-number">255</span>);
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">drawCircles</span>(width / <span class="hljs-number">2</span>, height / <span class="hljs-number">2</span>, <span class="hljs-number">320</span>);
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">}
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">drawCircles</span>(<span class="hljs-params">x, y, radius</span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">stroke</span>(<span class="hljs-number">0</span>);
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">noFill</span>();
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">circle</span>(x, y, radius * <span class="hljs-number">2</span>);
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">if</span> (radius &gt; <span class="hljs-number">4</span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">    <span class="hljs-title function_">drawCircles</span>(x + radius / <span class="hljs-number">2</span>, y, radius / <span class="hljs-number">2</span>);
    <span class="hljs-title function_">drawCircles</span>(x - radius / <span class="hljs-number">2</span>, y, radius / <span class="hljs-number">2</span>);
</code></pre><div class="comment"><p>Функція drawCircles() викликає себе двічі. Для кожного кола ліворуч і праворуч малюються кільця меншого розміру.</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  }
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">}
</code></pre><div class="comment"><p></p></div></div></div>
<p>Додайте ще два рядки коду, і тепер кожне коло міститиме чотири кола — ліворуч, праворуч, над і під центром.</p>
<div data-type="example">
  <h3 id="example-83-recursive-circles-four-times"><a class="heading-link" href="#example-83-recursive-circles-four-times">Приклад 8.3: Рекурсивні кільця по чотири за раз</a></h3>
  <figure>
    <div class="not-prose clear-both my-4 overflow-hidden rounded border bg-gray-100" style="max-width:1152px"><div class="relative overflow-hidden rounded-t bg-white"><!-- <div class="absolute left-[50%] top-[50%] -translate-x-[50%] -translate-y-[50%] ">Loading sketch ...</div> --><iframe class="w-full border-none transition-opacity opacity-1000" style="aspect-ratio:2.667" loading="lazy" src="./examples/08_fractals/8_3_recursion_circles"></iframe></div><div class="flex items-center justify-between border-t"><div class="flex"><button class="flex items-center border-r px-2.5 py-1.5 text-sm hover:bg-gray-200"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true" class="h-[15px] w-[15px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg><span class="ml-1.5">Reset</span></button><button class="flex items-center border-r px-2.5 py-1.5 text-sm hover:bg-gray-200"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span class="ml-1">Pause</span></button></div><a href="https://editor.p5js.org/natureofcode/sketches/JkT90swnM" target="_blank" rel="noreferrer" class="flex items-center px-2.5 text-[0.8rem] hover:underline">Open in Web Editor<svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="ml-1 text-gray-500" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></a></div></div>
    <figcaption></figcaption>
  </figure>
</div>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">drawCircles</span>(<span class="hljs-params">x, y, radius</span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">stroke</span>(<span class="hljs-number">0</span>);
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">noFill</span>();
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">circle</span>(x, y, radius * <span class="hljs-number">2</span>);
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">if</span> (radius &gt; <span class="hljs-number">16</span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">    <span class="hljs-title function_">drawCircles</span>(x + radius / <span class="hljs-number">2</span>, y, radius / <span class="hljs-number">2</span>);
    <span class="hljs-title function_">drawCircles</span>(x - radius / <span class="hljs-number">2</span>, y, radius / <span class="hljs-number">2</span>);
    <span class="hljs-title function_">drawCircles</span>(x, y + radius / <span class="hljs-number">2</span>, radius / <span class="hljs-number">2</span>);
    <span class="hljs-title function_">drawCircles</span>(x, y - radius / <span class="hljs-number">2</span>, radius / <span class="hljs-number">2</span>);
</code></pre><div class="comment"><p>Функція drawCircles() викликає себе чотири рази.</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  }
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">}
</code></pre><div class="comment"><p></p></div></div></div>
<p>Спробуйте відтворити цю програму за допомогою ітерації замість рекурсії!</p>
<h3 id="drawing-the-cantor-set-with-recursion"><a class="heading-link" href="#drawing-the-cantor-set-with-recursion">Малювання множини Кантора за допомогою рекурсії</a></h3>
<p>Тепер, коли я продемонстрував, як використовувати рекурсивні функції, я готовий візуалізувати множину Кантора. З чого мені почати? Добре, я знаю, що набір Кантора починається з лінії, тому я почну з цього і напишу функцію, яка малює лінію:</p>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">cantor</span>(<span class="hljs-params">x, y, length</span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">line</span>(x, y, x + length, y);
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">}
</code></pre><div class="comment"><p></p></div></div></div>
<p>Ця функція малює лінію з довжиною, вказаною у змінній <code>length</code>, яка починається в піксельних координатах <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x, y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mclose">)</span></span></span></span></span>. Лінія проведена горизонтально, але це довільне рішення. Припустимо, функція викликається наступним чином:</p>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-title function_">cantor</span>(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>, width - <span class="hljs-number">20</span>);
</code></pre><div class="comment"><p></p></div></div></div>
<p>Ви побачите щось схоже на малюнок 8.8.</p>
<figure>
  <div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:5334px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;334&#x27; width=&#x27;5334&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="./static/cb0a8a072e3af115e6bf7ac358d14fff/aafc8/08_fractals_10.webp 1334w,./static/cb0a8a072e3af115e6bf7ac358d14fff/51088/08_fractals_10.webp 2667w,./static/cb0a8a072e3af115e6bf7ac358d14fff/bb278/08_fractals_10.webp 5334w" sizes="(min-width: 5334px) 5334px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 5334px) 5334px, 100vw" decoding="async" loading="lazy" data-src="./static/cb0a8a072e3af115e6bf7ac358d14fff/9e1cb/08_fractals_10.png" data-srcset="./static/cb0a8a072e3af115e6bf7ac358d14fff/53d7b/08_fractals_10.png 1334w,./static/cb0a8a072e3af115e6bf7ac358d14fff/6b112/08_fractals_10.png 2667w,./static/cb0a8a072e3af115e6bf7ac358d14fff/9e1cb/08_fractals_10.png 5334w" alt="Малюнок 8.8: Результатом одного виклику функції cantor() є одна лінія"/></picture><noscript><picture><source type="image/webp" srcSet="./static/cb0a8a072e3af115e6bf7ac358d14fff/aafc8/08_fractals_10.webp 1334w,./static/cb0a8a072e3af115e6bf7ac358d14fff/51088/08_fractals_10.webp 2667w,./static/cb0a8a072e3af115e6bf7ac358d14fff/bb278/08_fractals_10.webp 5334w" sizes="(min-width: 5334px) 5334px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 5334px) 5334px, 100vw" decoding="async" loading="lazy" src="./static/cb0a8a072e3af115e6bf7ac358d14fff/9e1cb/08_fractals_10.png" srcSet="./static/cb0a8a072e3af115e6bf7ac358d14fff/53d7b/08_fractals_10.png 1334w,./static/cb0a8a072e3af115e6bf7ac358d14fff/6b112/08_fractals_10.png 2667w,./static/cb0a8a072e3af115e6bf7ac358d14fff/9e1cb/08_fractals_10.png 5334w" alt="Малюнок 8.8: Результатом одного виклику функції cantor() є одна лінія"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div>
  <figcaption>Малюнок 8.8: Результатом одного виклику функції <code>cantor()</code> є одна лінія</figcaption>
</figure>
<div class="half-width-right">
  <figure>
    <div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:1152px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;599&#x27; width=&#x27;1152&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="./static/dd20b90fb1a9e095d4d9f362c8249dc9/6354f/08_fractals_11.webp 288w,./static/dd20b90fb1a9e095d4d9f362c8249dc9/a3f1c/08_fractals_11.webp 576w,./static/dd20b90fb1a9e095d4d9f362c8249dc9/6c28e/08_fractals_11.webp 1152w" sizes="(min-width: 1152px) 1152px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 1152px) 1152px, 100vw" decoding="async" loading="lazy" data-src="./static/dd20b90fb1a9e095d4d9f362c8249dc9/635b3/08_fractals_11.png" data-srcset="./static/dd20b90fb1a9e095d4d9f362c8249dc9/5e15c/08_fractals_11.png 288w,./static/dd20b90fb1a9e095d4d9f362c8249dc9/ecaf8/08_fractals_11.png 576w,./static/dd20b90fb1a9e095d4d9f362c8249dc9/635b3/08_fractals_11.png 1152w" alt="Малюнок 8.9: Наступна ітерація ліній у множині Кантора становить одну тр етину довжини попередньої лінії"/></picture><noscript><picture><source type="image/webp" srcSet="./static/dd20b90fb1a9e095d4d9f362c8249dc9/6354f/08_fractals_11.webp 288w,./static/dd20b90fb1a9e095d4d9f362c8249dc9/a3f1c/08_fractals_11.webp 576w,./static/dd20b90fb1a9e095d4d9f362c8249dc9/6c28e/08_fractals_11.webp 1152w" sizes="(min-width: 1152px) 1152px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 1152px) 1152px, 100vw" decoding="async" loading="lazy" src="./static/dd20b90fb1a9e095d4d9f362c8249dc9/635b3/08_fractals_11.png" srcSet="./static/dd20b90fb1a9e095d4d9f362c8249dc9/5e15c/08_fractals_11.png 288w,./static/dd20b90fb1a9e095d4d9f362c8249dc9/ecaf8/08_fractals_11.png 576w,./static/dd20b90fb1a9e095d4d9f362c8249dc9/635b3/08_fractals_11.png 1152w" alt="Малюнок 8.9: Наступна ітерація ліній у множині Кантора становить одну третину довжини попередньої лінії"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div>
    <figcaption>Малюнок 8.9: Наступна ітерація ліній у множині Кантора становить одну третину довжини попередньої лінії</figcaption>
  </figure>
</div>
<p>Правило Кантора діє шляхом дублювання оригінальної лінії та стирання її середньої третини, залишаючи дві бічні лінії: одну від початку оригінального положення до однієї третини довжини, а іншу від положення двох третин до кінця лінії (див. малюнок 8.9). Я можу застосувати це правило вручну, викликавши функцію <code>line()</code> ще два рази, перемістивши <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span></span></span></span>-позицію вниз на 20 пікселів, щоб наступне покоління ліній з’явилося нижче першого.</p>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">cantor</span>(<span class="hljs-params">x, y, length</span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">line</span>(x, y, x + length, y);
</code></pre><div class="comment"><p></p></div></div><div class="bold pair split"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">line</span>(x, y + <span class="hljs-number">20</span>, x + length / <span class="hljs-number">3</span>, y + <span class="hljs-number">20</span>);
</code></pre><div class="comment"><p>Від початку до однієї третини.</p></div></div><div class="bold pair split"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">line</span>(x + (<span class="hljs-number">2</span> * length) / <span class="hljs-number">3</span>, y + <span class="hljs-number">20</span>, x + length, y + <span class="hljs-number">20</span>);
</code></pre><div class="comment"><p>Від двох третин до кінця.</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">}
</code></pre><div class="comment"><p></p></div></div></div>
<p>Малюнок 8.10 показує результат.</p>
<figure>
  <div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:2304px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;136&#x27; width=&#x27;2304&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="./static/6a8ef65998fe5770af1610dac86a6b07/2f3fc/08_fractals_12.webp 576w,./static/6a8ef65998fe5770af1610dac86a6b07/3c1e8/08_fractals_12.webp 1152w,./static/6a8ef65998fe5770af1610dac86a6b07/b3823/08_fractals_12.webp 2304w" sizes="(min-width: 2304px) 2304px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2304px) 2304px, 100vw" decoding="async" loading="lazy" data-src="./static/6a8ef65998fe5770af1610dac86a6b07/40980/08_fractals_12.png" data-srcset="./static/6a8ef65998fe5770af1610dac86a6b07/f585a/08_fractals_12.png 576w,./static/6a8ef65998fe5770af1610dac86a6b07/11ec5/08_fractals_12.png 1152w,./static/6a8ef65998fe5770af1610dac86a6b07/40980/08_fractals_12.png 2304w" alt="Малюнок 8.10: Два покоління ліній, намальованих за правилами набору Кантора"/></picture><noscript><picture><source type="image/webp" srcSet="./static/6a8ef65998fe5770af1610dac86a6b07/2f3fc/08_fractals_12.webp 576w,./static/6a8ef65998fe5770af1610dac86a6b07/3c1e8/08_fractals_12.webp 1152w,./static/6a8ef65998fe5770af1610dac86a6b07/b3823/08_fractals_12.webp 2304w" sizes="(min-width: 2304px) 2304px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2304px) 2304px, 100vw" decoding="async" loading="lazy" src="./static/6a8ef65998fe5770af1610dac86a6b07/40980/08_fractals_12.png" srcSet="./static/6a8ef65998fe5770af1610dac86a6b07/f585a/08_fractals_12.png 576w,./static/6a8ef65998fe5770af1610dac86a6b07/11ec5/08_fractals_12.png 1152w,./static/6a8ef65998fe5770af1610dac86a6b07/40980/08_fractals_12.png 2304w" alt="Малюнок 8.10: Два покоління ліній, намальованих за правилами набору Кантора"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div>
  <figcaption>Малюнок 8.10: Два покоління ліній, намальованих за правилами набору Кантора</figcaption>
</figure>
<p>Це працює для двох поколінь, але продовження ручних викликів функції <code>line()</code> швидко стане громіздким. Для наступних по колінь мені знадобиться 4, потім 8, потім 16 викликів <code>line()</code>. Цикл <code>for</code> — це звичайний спосіб розв&#x27;язання подібної проблеми, але спробуйте і ви побачите, що розрахунок для кожної ітерації швидко виявиться надзвичайно складним. Однак не впадайте у відчай, бо тут на допомогу приходить рекурсія!</p>
<div class="avoid-break">
  <p>Подивіться де я малюю першу лінію другого покоління, від початку до однієї третини її довжини:</p>
  <div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">line</span>(x, y + <span class="hljs-number">20</span>, x + length / <span class="hljs-number">3</span>, y + <span class="hljs-number">20</span>);
</code></pre><div class="comment"><p></p></div></div></div>
</div>
<p>Замість того, щоб безпосередньо викликати функцію <code>line()</code>, чому б не викликати функцію <code>cantor()</code>? Зрештою, що робить функція <code>cantor()</code>? Вона малює лінію в позиції <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x, y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mclose">)</span></span></span></span></span> із заданою довжиною <code>length</code>. Значення <code>x</code> залишається незмінним, <code>y</code> збільшується на 20, а довжина дорівнює <code>length / 3</code>:</p>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">cantor</span>(x, y + <span class="hljs-number">20</span>, length / <span class="hljs-number">3</span>);
</code></pre><div class="comment"><p></p></div></div></div>
<p>Цей виклик функції <code>cantor()</code> еквівалентний попередньому виклику функції <code>line()</code>. І для наступної лінії у другому поколінні я можу знову викликати <code>cantor()</code>:</p>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">cantor</span>(x + (<span class="hljs-number">2</span> * length / <span class="hljs-number">3</span>), y + <span class="hljs-number">20</span>, length / <span class="hljs-number">3</span>);
</code></pre><div class="comment"><p></p></div></div></div>
<p>Тепер функція <code>cantor()</code> виглядає так:</p>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">cantor</span>(<span class="hljs-params">x, y, length</span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">line</span>(x, y, x + len, y);
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">cantor</span>(x, y + <span class="hljs-number">20</span>, length / <span class="hljs-number">3</span>);
  <span class="hljs-title function_">cantor</span>(x + (<span class="hljs-number">2</span> * length / <span class="hljs-number">3</span>), y + <span class="hljs-number">20</span>, length / <span class="hljs-number">3</span>);
</code></pre><div class="comment"><p>Два рекурсивних виклики. Зауважте, що до y додається 20 пікселів.</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">}
</code></pre><div class="comment"><p></p></div></div></div>
<p>Оскільки функція <code>cantor()</code> тепер рекурсивна, те саме правило буде застосовано до наступної лінії й до наступної й до наступної поки <code>cantor()</code> викликатиме себе знову і знову! Але поки що не запускайте цей код. У програмі відсутній важливий елемент: умова виходу. У якийсь момент вона має припинити рекурсію. Тут я виберу умову для зупинки, якщо довжина лінії менше або дорівнює одному пікселю. Іншими словами, продовжуйте, поки значення <code>length</code> більше ніж <code>1</code>.</p>
<div class="avoid-break">
  <div data-type="example">
    <h3 id="example-84-the-cantor-set"><a class="heading-link" href="#example-84-the-cantor-set">Приклад 8.4: Множина Кантора</a></h3>
    <figure>
      <div class="not-prose clear-both my-4 overflow-hidden rounded border bg-gray-100" style="max-width:1152px"><div class="relative overflow-hidden rounded-t bg-white"><!-- <div class="absolute left-[50%] top-[50%] -translate-x-[50%] -translate-y-[50%] ">Loading sketch ...</div> --><iframe class="w-full border-none transition-opacity opacity-1000" style="aspect-ratio:2.667" loading="lazy" src="./examples/08_fractals/8_4_cantor_set"></iframe></div><div class="flex items-center justify-between border-t"><div class="flex"><button class="flex items-center border-r px-2.5 py-1.5 text-sm hover:bg-gray-200"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true" class="h-[15px] w-[15px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg><span class="ml-1.5">Reset</span></button><button class="flex items-center border-r px-2.5 py-1.5 text-sm hover:bg-gray-200"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span class="ml-1">Pause</span></button></div><a href="https://editor.p5js.org/natureofcode/sketches/4OW3OCzz6" target="_blank" rel="noreferrer" class="flex items-center px-2.5 text-[0.8rem] hover:underline">Open in Web Editor<svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="ml-1 text-gray-500" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></a></div></div>
      <figcaption></figcaption>
    </figure>
  </div>
  <div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">cantor</span>(<span class="hljs-params">x, y, length</span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">if</span> (length &gt; <span class="hljs-number">1</span>) {
</code></pre><div class="comment"><p>Продовжуємо, поки довжина більше за 1.</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">    <span class="hljs-title function_">line</span>(x, y, x + length, y);
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">    <span class="hljs-title function_">cantor</span>(x, y + <span class="hljs-number">20</span>, length / <span class="hljs-number">3</span>);
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">    <span class="hljs-title function_">cantor</span>(x + (<span class="hljs-number">2</span> * length) / <span class="hljs-number">3</span>, y + <span class="hljs-number">20</span>, length / <span class="hljs-number">3</span>);
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  }
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">}
</code></pre><div class="comment"><p></p></div></div></div>
</div>
<p>Написання функції, яка рекурсивно викликає саму себе є простим, елегантним способом для генерації фрактального візерунка, але це не дозволяє мені зробити нічого, окрім малювання візерунка. Наприклад, що потрібно зробити, якщо я хочу, щоб лінії у множині Кантора існували як окремі об’єкти, які можна переміщувати незалежно? Для цього мені потрібно використати інший підхід програмування, який застосовуватиме рекурсію в поєднанні з масивом, що відстежуватиме всі його окремі частини. Це саме те, що я буду робити далі!</p>
<div data-type="exercise" class="callout">
  <h3 id="exercise-81"><a class="heading-link" href="#exercise-81">Вправа 8.1</a></h3>
  <p>Використовуючи приклади 8.2 і 8.3 як шаблон, створіть власний рекурсивний візерунок. Нижче приклад з використанням ліній.</p>
  <figure>
    <div class="not-prose clear-both my-4 overflow-hidden rounded border bg-gray-100" style="max-width:1152px"><div class="relative overflow-hidden rounded-t bg-white"><!-- <div class="absolute left-[50%] top-[50%] -translate-x-[50%] -translate-y-[50%] ">Loading sketch ...</div> --><iframe class="w-full border-none transition-opacity opacity-1000" style="aspect-ratio:2.667" loading="lazy" src="./examples/08_fractals/exercise_8_1_fractal_lines"></iframe></div><div class="flex items-center justify-between border-t"><div class="flex"><button class="flex items-center border-r px-2.5 py-1.5 text-sm hover:bg-gray-200"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true" class="h-[15px] w-[15px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg><span class="ml-1.5">Reset</span></button><button class="flex items-center border-r px-2.5 py-1.5 text-sm hover:bg-gray-200"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span class="ml-1">Pause</span></button></div><a href="https://editor.p5js.org/natureofcode/sketches/tqFR5Oeki" target="_blank" rel="noreferrer" class="flex items-center px-2.5 text-[0.8rem] hover:underline">Open in Web Editor<svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="ml-1 text-gray-500" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></a></div></div>
    <figcaption></figcaption>
  </figure>
</div>
<h2 id="the-koch-curve"><a class="heading-link" href="#the-koch-curve">Крива Коха</a></h2>
<p>Тепер я звернуся до іншої відомої фрактальної моделі — <strong>кривої Коха</strong> — відкритої у 1904 році шведським математиком Гельґе фон Кохом. На малюнку 8.11 наведено правила створення цього фракталу. Зверніть увагу, що правила починаються так само як і набір Кантора, з однієї лінії, яка потім ділиться на три рівні частини.</p>
<figure>
  <div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:2304px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;1041&#x27; width=&#x27;2304&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="./static/6cf774a6b34fc2606b87667933aab9fc/3af8f/08_fractals_13.webp 576w,./static/6cf774a6b34fc2606b87667933aab9fc/f4999/08_fractals_13.webp 1152w,./static/6cf774a6b34fc2606b87667933aab9fc/f2af9/08_fractals_13.webp 2304w" sizes="(min-width: 2304px) 2304px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2304px) 2304px, 100vw" decoding="async" loading="lazy" data-src="./static/6cf774a6b34fc2606b87667933aab9fc/e9174/08_fractals_13.png" data-srcset="./static/6cf774a6b34fc2606b87667933aab9fc/0a313/08_fractals_13.png 576w,./static/6cf774a6b34fc2606b87667933aab9fc/8c635/08_fractals_13.png 1152w,./static/6cf774a6b34fc2606b87667933aab9fc/e9174/08_fractals_13.png 2304w" alt="Малюнок 8.11: Правила малювання кривої Коха"/></picture><noscript><picture><source type="image/webp" srcSet="./static/6cf774a6b34fc2606b87667933aab9fc/3af8f/08_fractals_13.webp 576w,./static/6cf774a6b34fc2606b87667933aab9fc/f4999/08_fractals_13.webp 1152w,./static/6cf774a6b34fc2606b87667933aab9fc/f2af9/08_fractals_13.webp 2304w" sizes="(min-width: 2304px) 2304px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2304px) 2304px, 100vw" decoding="async" loading="lazy" src="./static/6cf774a6b34fc2606b87667933aab9fc/e9174/08_fractals_13.png" srcSet="./static/6cf774a6b34fc2606b87667933aab9fc/0a313/08_fractals_13.png 576w,./static/6cf774a6b34fc2606b87667933aab9fc/8c635/08_fractals_13.png 1152w,./static/6cf774a6b34fc2606b87667933aab9fc/e9174/08_fractals_13.png 2304w" alt="Малюнок 8.11: Правила малювання кривої Коха"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div>
  <figcaption>Малюнок 8.11: Правила малювання кривої Коха</figcaption>
</figure>
<p>На малюнку 8.12 показано, як фрактал розвивається протягом кількох повторень цих кроків.</p>
<figure>
  <div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:1800px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;197.99999999999997&#x27; width=&#x27;1800&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="./static/6b89d33962a4386748bcf0f2a3503cd5/c9691/08_fractals_14.webp 450w,./static/6b89d33962a4386748bcf0f2a3503cd5/44fdb/08_fractals_14.webp 900w,./static/6b89d33962a4386748bcf0f2a3503cd5/a37b7/08_fractals_14.webp 1800w" sizes="(min-width: 1800px) 1800px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 1800px) 1800px, 100vw" decoding="async" loading="lazy" data-src="./static/6b89d33962a4386748bcf0f2a3503cd5/a4fc8/08_fractals_14.png" data-srcset="./static/6b89d33962a4386748bcf0f2a3503cd5/11e9f/08_fractals_14.png 450w,./static/6b89d33962a4386748bcf0f2a3503cd5/1a183/08_fractals_14.png 900w,./static/6b89d33962a4386748bcf0f2a3503cd5/a4fc8/08_fractals_14.png 1800w" alt="Малюнок 8.12: Розвиток кривої Коха"/></picture><noscript><picture><source type="image/webp" srcSet="./static/6b89d33962a4386748bcf0f2a3503cd5/c9691/08_fractals_14.webp 450w,./static/6b89d33962a4386748bcf0f2a3503cd5/44fdb/08_fractals_14.webp 900w,./static/6b89d33962a4386748bcf0f2a3503cd5/a37b7/08_fractals_14.webp 1800w" sizes="(min-width: 1800px) 1800px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 1800px) 1800px, 100vw" decoding="async" loading="lazy" src="./static/6b89d33962a4386748bcf0f2a3503cd5/a4fc8/08_fractals_14.png" srcSet="./static/6b89d33962a4386748bcf0f2a3503cd5/11e9f/08_fractals_14.png 450w,./static/6b89d33962a4386748bcf0f2a3503cd5/1a183/08_fractals_14.png 900w,./static/6b89d33962a4386748bcf0f2a3503cd5/a4fc8/08_fractals_14.png 1800w" alt="Малюнок 8.12: Розвиток кривої Коха"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div>
  <figcaption>Малюнок 8.12: Розвиток кривої Коха</figcaption>
</figure>
<p>Я міг би діяти так само як і з множиною Кантора й написати рекурсивну функцію, яка послідовно застосовує правила Коха знову і знову. Натомість я збираюся виконувати цю задачу інакше, розглядаючи кожен сегмент кривої Коха як окремий об’єкт. Це відкриє деякі захопливі дизайнерські можливості. Наприклад, якщо кожен сегмент є об’єктом, він може незалежно рухатися зі свого початкового положення та брати участь у фізичному моделюванні. Крім того, візуальний вигляд кожного сегмента може відрізнятися, якщо об’єкт містить настроювані властивості кольору, товщини лінії тощо.</p>
<div data-type="note" class="callout">
  <h3 id="the-monster-curve"><a class="heading-link" href="#the-monster-curve">Крива монстра</a></h3>
  <p>Криву Коха та інші фрактальні моделі часто називають <em>математичними монстрами</em> через парадокс, який виникає, коли ви застосовуєте рекурсивне правило нескінченну кількість разів. Якщо довжина вихідної початкової лінії дорівнює 1, перша ітерація кривої Коха дасть лінію довжиною чотири третини (кожен сегмент становить одну третину довжини початкової лінії). Зробіть це ще раз, і ви отримаєте довжину шістнадцять дев’ятих. Коли ви ітеруєте цей процес нескінченно, довжина кривої Коха наближається до нескінченності, але вона вміщується в крихітний кінцевий простір, наданий прямо тут, на цьому папері (або екрані)!</p>
  <p>Оскільки ви працюєте у світі p5.js  зі скінченними пікселями, цей теоретичний парадокс не матиме значення. Вам просто доведеться обмежити кількість разів рекурсивного застосовання правил Коха, щоб вашій програмі вистачило пам’яті та не виникло збою.</p>
</div>
<p>Щоб досягти мети у створенні кожного сегменту як окремого об’єкту, я повинен спочатку вирішити, яким цей об’єкт повинен бути в першу чергу. Які дані він повинен зберігати? Які методи він повинен мати? Крива Коха — це ряд з’єднаних ліній, тому я буду розглядати кожен сегмент як лінію Коха — <code>KochLine</code>. Кожен об’єкт <code>KochLine</code> матиме початкову точку <code>a</code> і кінцеву точку <code>b</code>. Ці точки будуть представлені як об’єкти <code>p5.Vector</code>, а лінія малюватиметься за допомогою функції <code>line()</code>:</p>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">KochLine</span> {
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">a, b</span>) {
</code></pre><div class="comment"><p>Пряма між двома точками: a і b.</p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">    <span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span> = a.<span class="hljs-title function_">copy</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span> = b.<span class="hljs-title function_">copy</span>();
</code></pre><div class="comment"><p>a і b є об’єктами типу p5.Vector.</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  }
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">show</span>(<span class="hljs-params"></span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">    <span class="hljs-title function_">stroke</span>(<span class="hljs-number">0</span>);
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">    <span class="hljs-title function_">line</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span>.<span class="hljs-property">x</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span>.<span class="hljs-property">y</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span>.<span class="hljs-property">x</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span>.<span class="hljs-property">y</span>);
</code></pre><div class="comment"><p>Проведення лінії від точки a до b.</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  }
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">}
</code></pre><div class="comment"><p></p></div></div></div>
<p>Тепер, коли у мене є клас <code>KochLine</code>, я можу перейти до роботи з функціями <code>setup()</code> і <code>draw()</code>. Мені знадобиться структура даних, щоб відстежувати те, що згодом стане багатьма об’єктами <code>KochLine</code>, і JavaScript масив цілком підійде (перегляньте <a href="/particles#section-particles">Розділ 4</a> для перегляду масивів):</p>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">let</span> segments = [];
</code></pre><div class="comment"><p></p></div></div></div>
<div class="avoid-break">
  <p>У функції <code>setup()</code> я хочу додати до масиву перший відрізок лінії, яка тягнеться від 0 до ширини полотна:</p>
  <div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">createCanvas</span>(<span class="hljs-number">640</span>, <span class="hljs-number">240</span>);
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">let</span> start = <span class="hljs-title function_">createVector</span>(<span class="hljs-number">0</span>, <span class="hljs-number">200</span>);
</code></pre><div class="comment"><p>Ліва сторона полотна.</p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">let</span> end = <span class="hljs-title function_">createVector</span>(width, <span class="hljs-number">200</span>);
</code></pre><div class="comment"><p>Права сторона полотна.</p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  segments.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">KochLine</span>(start, end));
</code></pre><div class="comment"><p>Перший об&#x27;єкт KochLine.</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">}
</code></pre><div class="comment"><p></p></div></div></div>
</div>
<p>Потім у функції <code>draw()</code> усі об’єкти <code>KochLine</code> (наразі лише один) можна відобразити за допомогою циклу <code>for...of</code>:</p>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">draw</span>(<span class="hljs-params"></span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">background</span>(<span class="hljs-number">255</span>);
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> segment <span class="hljs-keyword">of</span> segments) {
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">    segment.<span class="hljs-title function_">show</span>();
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  }
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">}
</code></pre><div class="comment"><p></p></div></div></div>
<p>Це моя основа для програми. У мене є клас <code>KochLine</code>, який відстежує лінію від точки <code>start</code> до точки <code>end</code>, і є масив, який відстежує всі об’єкти <code>KochLine</code>. Маючи ці елементи, як і де я маю застосувати правила Коха та принципи рекурсії?</p>
<p>Пам’ятаєте клітинний автомат Гра Життя з <a href="/cellular-automata#section-cellular-automata">Розділу 7</a>? У тій симуляції я завжди відстежував два покоління: поточне та наступне. Коли я закінчував обчислення наступного покоління, <em>наступне</em> ставало <em>поточним</em>, і я переходив до обчислень нового наступного покоління. Тут я збираюся застосувати подібний підхід. У мене є масив  <code>segments</code> із переліком поточного набору відрізків ліній (на початку програми є лише один). Тепер мені потрібен другий масив (я назву його <code>next</code>) куди я зможу додавати усі нові об’єкти <code>KochLine</code>, створені у результаті застосування правил Коха. Для кожного окремого елемента <code>KochLine</code> поточного масиву буде додано чотири нові сегменти до <code>next</code>. Коли я закінчу, масив <code>next</code> стане новим масивом <code>segments</code> (див. малюнок 8.13).</p>
<figure>
  <div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:2304px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;1174&#x27; width=&#x27;2304&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="./static/9e3f0d0c021f99b860adb41093e72cbf/58005/08_fractals_15.webp 576w,./static/9e3f0d0c021f99b860adb41093e72cbf/707d5/08_fractals_15.webp 1152w,./static/9e3f0d0c021f99b860adb41093e72cbf/d9d8b/08_fractals_15.webp 2304w" sizes="(min-width: 2304px) 2304px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2304px) 2304px, 100vw" decoding="async" loading="lazy" data-src="./static/9e3f0d0c021f99b860adb41093e72cbf/d2ca3/08_fractals_15.png" data-srcset="./static/9e3f0d0c021f99b860adb41093e72cbf/024cd/08_fractals_15.png 576w,./static/9e3f0d0c021f99b860adb41093e72cbf/4800b/08_fractals_15.png 1152w,./static/9e3f0d0c021f99b860adb41093e72cbf/d2ca3/08_fractals_15.png 2304w" alt="Малюнок 8.13: Наступне покоління фракталу обчислюється з поточного покоління. Потім, при переході від одного покоління до іншого, масив next стає новим масивом current"/></picture><noscript><picture><source type="image/webp" srcSet="./static/9e3f0d0c021f99b860adb41093e72cbf/58005/08_fractals_15.webp 576w,./static/9e3f0d0c021f99b860adb41093e72cbf/707d5/08_fractals_15.webp 1152w,./static/9e3f0d0c021f99b860adb41093e72cbf/d9d8b/08_fractals_15.webp 2304w" sizes="(min-width: 2304px) 2304px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2304px) 2304px, 100vw" decoding="async" loading="lazy" src="./static/9e3f0d0c021f99b860adb41093e72cbf/d2ca3/08_fractals_15.png" srcSet="./static/9e3f0d0c021f99b860adb41093e72cbf/024cd/08_fractals_15.png 576w,./static/9e3f0d0c021f99b860adb41093e72cbf/4800b/08_fractals_15.png 1152w,./static/9e3f0d0c021f99b860adb41093e72cbf/d2ca3/08_fractals_15.png 2304w" alt="Малюнок 8.13: Наступне покоління фракталу обчислюється з поточного покоління. Потім, при переході від одного покоління до іншого, масив next стає новим масивом current"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div>
  <figcaption>Малюнок 8.13: Наступне покоління фракталу обчислюється з поточного покоління. Потім, при переході від одного покоління до іншого, масив <code>next</code> стає новим масивом <code>current</code></figcaption>
</figure>
<p>Ось як зараз виглядає код:</p>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">generate</span>(<span class="hljs-params"></span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">let</span> next = [];
</code></pre><div class="comment"><p>Створюємо масив next.</p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> segment <span class="hljs-keyword">of</span> segments) {
</code></pre><div class="comment"><p>Для кожного сегмента...</p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">    next.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">KochLine</span>(????, ????));
    next.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">KochLine</span>(????, ????));
    next.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">KochLine</span>(????, ????));
    next.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">KochLine</span>(????, ????));
</code></pre><div class="comment"><p>...додаємо чотири нові лінії. Як нам обчислити початкову та кінцеву точки кожної лінії?</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  }
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  segments = next;
</code></pre><div class="comment"><p>Масив next стає масивом segments!</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">}
</code></pre><div class="comment"><p></p></div></div></div>
<p>Викликаючи функцію <code>generate()</code> знову і знову, правила кривої Коха будуть рекурсивно застосовані до набору сегментів <code>KochLine</code>, що вже існують. Але, звісно, я пропустив реальну роботу функції: як мені насправді розбити один відрізок лінії на чотири, як описано у правилах? Мені потрібен спосіб обчислення початкової та кінцевої точок кожної лінії.</p>
<p>Оскільки у класі <code>KochLine</code> для зберігання початкової та кінцевої точок використовуються об’єкти <code>p5.Vector</code>, це чудова нагода попрактикуватися в усій цій векторній математиці з <a href="/vectors#section-vectors">Розділу 1</a>, а також застосувати трохи тригонометрії з <a href="/oscillation#section-oscillation">Розділу 3</a>. По-перше, я повинен визначити обсяг проблеми: скільки точок мені потрібно обчислити для кожного об’єкта <code>KochLine</code>? Відповідь показано на малюнку 8.14.</p>
<figure>
  <div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:2304px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;332&#x27; width=&#x27;2304&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="./static/68d92c52096e7eb87747956ca4a0c272/525df/08_fractals_16.webp 576w,./static/68d92c52096e7eb87747956ca4a0c272/2e96d/08_fractals_16.webp 1152w,./static/68d92c52096e7eb87747956ca4a0c272/5e326/08_fractals_16.webp 2304w" sizes="(min-width: 2304px) 2304px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2304px) 2304px, 100vw" decoding="async" loading="lazy" data-src="./static/68d92c52096e7eb87747956ca4a0c272/c231a/08_fractals_16.png" data-srcset="./static/68d92c52096e7eb87747956ca4a0c272/76fc1/08_fractals_16.png 576w,./static/68d92c52096e7eb87747956ca4a0c272/3c33e/08_fractals_16.png 1152w,./static/68d92c52096e7eb87747956ca4a0c272/c231a/08_fractals_16.png 2304w" alt="Малюнок 8.14: Дві точки стають п&#x27;ятьма точками"/></picture><noscript><picture><source type="image/webp" srcSet="./static/68d92c52096e7eb87747956ca4a0c272/525df/08_fractals_16.webp 576w,./static/68d92c52096e7eb87747956ca4a0c272/2e96d/08_fractals_16.webp 1152w,./static/68d92c52096e7eb87747956ca4a0c272/5e326/08_fractals_16.webp 2304w" sizes="(min-width: 2304px) 2304px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2304px) 2304px, 100vw" decoding="async" loading="lazy" src="./static/68d92c52096e7eb87747956ca4a0c272/c231a/08_fractals_16.png" srcSet="./static/68d92c52096e7eb87747956ca4a0c272/76fc1/08_fractals_16.png 576w,./static/68d92c52096e7eb87747956ca4a0c272/3c33e/08_fractals_16.png 1152w,./static/68d92c52096e7eb87747956ca4a0c272/c231a/08_fractals_16.png 2304w" alt="Малюнок 8.14: Дві точки стають п&#x27;ятьма точками"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div>
  <figcaption>Малюнок 8.14: Дві точки стають п&#x27;ятьма точками</figcaption>
</figure>
<p>Як показано на малюнку, мені потрібно перетворити дві точки (<em>start</em>, <em>end</em>) на п’ять (<em>a</em>, <em>b</em>, <em>c</em>, <em>d</em>, <em>e</em>), щоб створити чотири нові відрізки (<span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>→</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a → b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">b</span></span></span></span></span>, <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>→</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">b → c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">c</span></span></span></span></span>, <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>→</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">c → d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">d</span></span></span></span></span>, <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>→</mo><mi>e</mi></mrow><annotation encoding="application/x-tex">d → e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">e</span></span></span></span></span>):</p>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript">    next.<span class="hljs-title function_">add</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">KochLine</span>(a, b));
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">    next.<span class="hljs-title function_">add</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">KochLine</span>(b, c));
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">    next.<span class="hljs-title function_">add</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">KochLine</span>(c, d));
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">    next.<span class="hljs-title function_">add</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">KochLine</span>(d, e));
</code></pre><div class="comment"><p></p></div></div></div>
<p>Де отримати ці точки? Чому б не попросити об’єкт <code>KochLine</code> розрахувати їх за мене?</p>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">generate</span>(<span class="hljs-params"></span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">let</span> next = [];
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> segment <span class="hljs-keyword">of</span> segments) {
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">    <span class="hljs-keyword">let</span> [a, b, c, d, e] = segment.<span class="hljs-title function_">kochPoints</span>();
    next.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">KochLine</span>(a, b));
    next.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">KochLine</span>(b, c));
    next.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">KochLine</span>(c, d));
    next.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">KochLine</span>(d, e));
</code></pre><div class="comment"><p>KochLine потребує методу, який повертатиме 5 точок, обчислених згідно з правилами Коха.</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  }
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  segments = next;
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">}
</code></pre><div class="comment"><p></p></div></div></div>
<p>Зачекайте, придивімось на один рядок коду трохи уважніше:</p>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair split"><pre><code class="hljs code language-javascript">    <span class="hljs-keyword">let</span> [a, b, c, d, e] = segment.<span class="hljs-title function_">kochPoints</span>();
</code></pre><div class="comment"><p>Це деструктуризація, але для масиву!</p></div></div></div>
<p>Як ви можете пригадати з <a href="/physics-libraries#section-physics-libraries">Розділу 6</a>, я пояснював <strong>деструктуризацію об’єкта</strong> як спосіб витягування властивостей з об’єкта та присвоєння їх окремим змінним. Вгадайте що? Ви можете робити те саме з масивами! Тут, якщо метод <code>kochPoints()</code> повертає масив із п’яти елементів, я можу зручно розпакувати та призначити їх, відповідним змінним: <code>a</code>, <code>b</code>, <code>c</code>, <code>d</code> та <code>e</code>. Це чудовий спосіб обробки кількох повернених значень. Так само як і з об’єктами, <strong>деструктуризація масиву</strong> підтримує акуратність коду.</p>
<p>Тепер мені потрібно просто написати новий метод <code>kochPoints()</code> у класі <code>KochLine</code>, який повертатиме масив об’єктів <code>p5.Vector</code>, що представляють точки від <em>a</em> до <em>e</em>, які показані на малюнку 8.15. Спочатку я пропишу найпростіші точки <em>a</em> та <em>e</em> — вони є лише копіями точок <code>start</code> та <code>end</code> з початкової лінії:</p>
<div class="snip-below">
  <div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">kochPoints</span>(<span class="hljs-params"></span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">    <span class="hljs-keyword">let</span> a = <span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span>.<span class="hljs-title function_">copy</span>();
</code></pre><div class="comment"><p>Зверніть увагу на використання методу copy(). Як обговорювалося у Розділі 5, краще уникати створення копій,
коли це можливо, але тут потрібен новий об&#x27;єкт на випадок, якщо сегменти
повинні рухатися незалежно один від одного.</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">    <span class="hljs-keyword">let</span> e = <span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span>.<span class="hljs-title function_">copy</span>();
</code></pre><div class="comment"><p></p></div></div></div>
</div>
<p>Як щодо точок <em>b</em> і <em>d</em>? Точка <em>b</em> лежить на одній третій довжини від початку відрізка, а <em>d</em> — це відстань, що складає дві третини від початку лінії. Як показано на малюнку 8.15, якщо я створю вектор <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>v</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.714em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.03588em">v</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.2077em"><span class="overlay" style="height:0.714em;width:0.471em"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span></span></span></span></span></span></span></span>, що вказує від оригінального значення <em>start</em> до кінцевого <em>end</em>, тоді я можу знайти нові точки, масштабуючи його магнітуду до однієї третини для нової точки <em>b</em> і двох третин для нової точки <em>d</em>.</p>
<figure>
  <div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:2304px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;465.99999999999994&#x27; width=&#x27;2304&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="./static/a618984902120e150bed1fc95ecbbf7f/4a129/08_fractals_17.webp 576w,./static/a618984902120e150bed1fc95ecbbf7f/d9810/08_fractals_17.webp 1152w,./static/a618984902120e150bed1fc95ecbbf7f/2a3aa/08_fractals_17.webp 2304w" sizes="(min-width: 2304px) 2304px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2304px) 2304px, 100vw" decoding="async" loading="lazy" data-src="./static/a618984902120e150bed1fc95ecbbf7f/5a883/08_fractals_17.png" data-srcset="./static/a618984902120e150bed1fc95ecbbf7f/72481/08_fractals_17.png 576w,./static/a618984902120e150bed1fc95ecbbf7f/15068/08_fractals_17.png 1152w,./static/a618984902120e150bed1fc95ecbbf7f/5a883/08_fractals_17.png 2304w" alt="Малюнок 8.15: Початкову лінію, виражену через вектор \vec{v}, можна розділити на 3, щоб знайти положення точок для наступного покоління"/></picture><noscript><picture><source type="image/webp" srcSet="./static/a618984902120e150bed1fc95ecbbf7f/4a129/08_fractals_17.webp 576w,./static/a618984902120e150bed1fc95ecbbf7f/d9810/08_fractals_17.webp 1152w,./static/a618984902120e150bed1fc95ecbbf7f/2a3aa/08_fractals_17.webp 2304w" sizes="(min-width: 2304px) 2304px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2304px) 2304px, 100vw" decoding="async" loading="lazy" src="./static/a618984902120e150bed1fc95ecbbf7f/5a883/08_fractals_17.png" srcSet="./static/a618984902120e150bed1fc95ecbbf7f/72481/08_fractals_17.png 576w,./static/a618984902120e150bed1fc95ecbbf7f/15068/08_fractals_17.png 1152w,./static/a618984902120e150bed1fc95ecbbf7f/5a883/08_fractals_17.png 2304w" alt="Малюнок 8.15: Початкову лінію, виражену через вектор \vec{v}, можна розділити на 3, щоб знайти положення точок для наступного покоління"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div>
  <figcaption>Малюнок 8.15: Початкову лінію, виражену через вектор <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>v</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.714em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.03588em">v</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.2077em"><span class="overlay" style="height:0.714em;width:0.471em"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span></span></span></span></span></span></span></span>, можна розділити на 3, щоб знайти положення точок для наступного покоління</figcaption>
</figure>
<p>Ось як це виглядає у коді:</p>
<div class="snip-above snip-below">
  <div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair split"><pre><code class="hljs code language-javascript">    <span class="hljs-keyword">let</span> v = p5.<span class="hljs-property">Vector</span>.<span class="hljs-title function_">sub</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span>);
</code></pre><div class="comment"><p>Створимо вектор від start до end.</p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">    v.<span class="hljs-title function_">div</span>(<span class="hljs-number">3</span>);
</code></pre><div class="comment"><p>Втричі скоротимо довжину.</p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">    <span class="hljs-keyword">let</span> b = p5.<span class="hljs-property">Vector</span>.<span class="hljs-title function_">add</span>(a, v);
</code></pre><div class="comment"><p>Додамо одну третину вектора до початку лінії, щоб знайти точку b.</p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">    <span class="hljs-keyword">let</span> d = p5.<span class="hljs-property">Vector</span>.<span class="hljs-title function_">add</span>(b, v);
</code></pre><div class="comment"><p>d — це ще одна третина шляху від точки b!</p></div></div></div>
</div>
<div class="half-width-right">
  <figure>
    <div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:1152px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;470&#x27; width=&#x27;1152&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="./static/20f03c688993a20395c03f806fc7c53f/970ee/08_fractals_18.webp 288w,./static/20f03c688993a20395c03f806fc7c53f/1006d/08_fractals_18.webp 576w,./static/20f03c688993a20395c03f806fc7c53f/e9d34/08_fractals_18.webp 1152w" sizes="(min-width: 1152px) 1152px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 1152px) 1152px, 100vw" decoding="async" loading="lazy" data-src="./static/20f03c688993a20395c03f806fc7c53f/e1c76/08_fractals_18.png" data-srcset="./static/20f03c688993a20395c03f806fc7c53f/b069a/08_fractals_18.png 288w,./static/20f03c688993a20395c03f806fc7c53f/1925e/08_fractals_18.png 576w,./static/20f03c688993a20395c03f806fc7c53f/e1c76/08_fractals_18.png 1152w" alt="Малюнок 8.16: Вектор \vec{v} повернуто на 60 градусів, щоб знайти третю точку"/></picture><noscript><picture><source type="image/webp" srcSet="./static/20f03c688993a20395c03f806fc7c53f/970ee/08_fractals_18.webp 288w,./static/20f03c688993a20395c03f806fc7c53f/1006d/08_fractals_18.webp 576w,./static/20f03c688993a20395c03f806fc7c53f/e9d34/08_fractals_18.webp 1152w" sizes="(min-width: 1152px) 1152px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 1152px) 1152px, 100vw" decoding="async" loading="lazy" src="./static/20f03c688993a20395c03f806fc7c53f/e1c76/08_fractals_18.png" srcSet="./static/20f03c688993a20395c03f806fc7c53f/b069a/08_fractals_18.png 288w,./static/20f03c688993a20395c03f806fc7c53f/1925e/08_fractals_18.png 576w,./static/20f03c688993a20395c03f806fc7c53f/e1c76/08_fractals_18.png 1152w" alt="Малюнок 8.16: Вектор \vec{v} повернуто на 60 градусів, щоб знайти третю точку"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div>
    <figcaption>Малюнок 8.16: Вектор <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>v</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.714em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.03588em">v</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.2077em"><span class="overlay" style="height:0.714em;width:0.471em"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span></span></span></span></span></span></span></span> повернуто на <em>60 градусів</em>, щоб знайти третю точку</figcaption>
  </figure>
</div>
<p>Остання точка <em>c</em> є найскладнішою для обчислення. Однак, якщо врахувати, що всі кути рівностороннього трикутника дорівнюють 60 градусам, це одразу полегшить нашу роботу. Якщо ми знаємо як знайти нову точку <em>b</em> із вектором, що становить одну третину довжини прямої, то можна повернути той самий вектор на 60 градусів (або <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mi mathvariant="normal">/</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">\pi/3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="mord">/3</span></span></span></span></span> радіан) і додати його до <em>b</em>, як на малюнку 8.16. Тоді ми прийдемо до точки <em>c</em>!</p>
<div class="snip-above snip-below">
  <div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair split"><pre><code class="hljs code language-javascript">    v.<span class="hljs-title function_">rotate</span>(-<span class="hljs-variable constant_">PI</span> / <span class="hljs-number">3</span>);
</code></pre><div class="comment"><p>Поворот на –π/3 радіан (від’ємний кут, щоб він повертав “угору”).</p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">    <span class="hljs-keyword">let</span> c = p5.<span class="hljs-property">Vector</span>.<span class="hljs-title function_">add</span>(b, v);
</code></pre><div class="comment"><p>Перехід від b до v, щоб дістатися до точки c.</p></div></div></div>
</div>
<p>Нарешті, після обчислення п’яти точок, я можу п овернути їх усі разом у масиві. Це відповідатиме коду для деструктуризації масиву на п’ять окремих змінних, як було описано раніше:</p>
<div class="snip-above">
  <div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair split"><pre><code class="hljs code language-javascript">    <span class="hljs-keyword">return</span> [a, b, c, d, e];
  }
</code></pre><div class="comment"><p>Повернення п’ятьох точок у масиві.</p></div></div></div>
</div>
<p>Тепер залишається лише викликати функцію <code>generate()</code> певну кількість разів (скажімо, п’ять), щоб у функції <code>setup()</code> обчислити відрізки лінії Коха до вказаного покоління.</p>
<div data-type="example">
  <h3 id="example-85-the-koch-curve"><a class="heading-link" href="#example-85-the-koch-curve">Приклад 8.5: Крива Коха</a></h3>
  <figure>
    <div class="not-prose clear-both my-4 overflow-hidden rounded border bg-gray-100" style="max-width:1152px"><div class="relative overflow-hidden rounded-t bg-white"><!-- <div class="absolute left-[50%] top-[50%] -translate-x-[50%] -translate-y-[50%] ">Loading sketch ...</div> --><iframe class="w-full border-none transition-opacity opacity-1000" style="aspect-ratio:2.667" loading="lazy" src="./examples/08_fractals/8_5_koch_curve"></iframe></div><div class="flex items-center justify-between border-t"><div class="flex"><button class="flex items-center border-r px-2.5 py-1.5 text-sm hover:bg-gray-200"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true" class="h-[15px] w-[15px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg><span class="ml-1.5">Reset</span></button><button class="flex items-center border-r px-2.5 py-1.5 text-sm hover:bg-gray-200"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span class="ml-1">Pause</span></button></div><a href="https://editor.p5js.org/natureofcode/sketches/Tbb2MVsA9" target="_blank" rel="noreferrer" class="flex items-center px-2.5 text-[0.8rem] hover:underline">Open in Web Editor<svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="ml-1 text-gray-500" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></a></div></div>
    <figcaption></figcaption>
  </figure>
</div>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">let</span> segments = [];
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">createCanvas</span>(<span class="hljs-number">640</span>, <span class="hljs-number">240</span>);
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">let</span> start = <span class="hljs-title function_">createVector</span>(<span class="hljs-number">0</span>, <span class="hljs-number">200</span>);
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">let</span> end = <span class="hljs-title function_">createVector</span>(width, <span class="hljs-number">200</span>);
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  segments.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">KochLine</span>(start, end));
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) {
    <span class="hljs-title function_">generate</span>();
  }
</code></pre><div class="comment"><p>Застосування правила Коха п&#x27;ять разів.</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">}
</code></pre><div class="comment"><p></p></div></div></div>
<p>У цьому прикладі я вирішив викликати функцію <code>generate()</code>. Щоразу, коли застосовуються правила Коха, кількість відрізків лінії зростає експоненціально. Після п’яти ітерацій я матиму 1024 сегменти, які забезпечують значну деталізованість для перегляду патерну. Однак ви можете використовувати підхід, застосований у попередніх прикладах, встановивши порогове значення для мінімальної довжини сегмента і викликаючи функцію <code>generate()</code> доки сегменти не стануть занадто малими. Крім того, ви можете розглянути інтерактивний варіант із кнопкою, яка з кожним натисканням розвиватиме форму до наступного покоління.</p>
<div data-type="exercise" class="callout">
  <h3 id="exercise-82"><a class="heading-link" href="#exercise-82">Вправа 8.2</a></h3>
  <p>Намалюйте сніжинку Коха, яка складається з трьох кривих Коха, розташованих у вигляді трикутника. Або намалюйте інший варіант кривої Коха.</p>
  <figure>
    <div class="not-prose clear-both my-4 overflow-hidden rounded border bg-gray-100" style="max-width:1152px"><div class="relative overflow-hidden rounded-t bg-white"><!-- <div class="absolute left-[50%] top-[50%] -translate-x-[50%] -translate-y-[50%] ">Loading sketch ...</div> --><iframe class="w-full border-none transition-opacity opacity-1000" style="aspect-ratio:2.667" loading="lazy" src="./examples/08_fractals/exercise_8_2_koch_snowflake"></iframe></div><div class="flex items-center justify-between border-t"><div class="flex"><button class="flex items-center border-r px-2.5 py-1.5 text-sm hover:bg-gray-200"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true" class="h-[15px] w-[15px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg><span class="ml-1.5">Reset</span></button><button class="flex items-center border-r px-2.5 py-1.5 text-sm hover:bg-gray-200"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span class="ml-1">Pause</span></button></div><a href="https://editor.p5js.org/natureofcode/sketches/GLil3E3qK" target="_blank" rel="noreferrer" class="flex items-center px-2.5 text-[0.8rem] hover:underline">Open in Web Editor<svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="ml-1 text-gray-500" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></a></div></div>
    <figcaption></figcaption>
  </figure>
</div>
<div data-type="exercise" class="callout">
  <h3 id="exercise-83"><a class="heading-link" href="#exercise-83">Вправа 8.3</a></h3>
  <p>Спробуйте анімувати криву Коха. Наприклад, чи можна намалювати його зліва направо? Чи можете ви змінити візуальне оформлення відрізків лінії? Чи зможете ви рухати відрізки, використовуючи методи з попередніх розділів? Що, якщо ви перетворите кожен сегмент лінії на пружину (Toxiclibs.js) або обмеження (Matter.js)?</p>
</div>
<div data-type="exercise" class="callout">
  <h3 id="exercise-84"><a class="heading-link" href="#exercise-84">Вправа 8.4</a></h3>
  <p>Перепишіть приклад множини Кантора, використовуючи об’єкти й масив.</p>
</div>
<div data-type="exercise" class="callout">
  <h3 id="exercise-85"><a class="heading-link" href="#exercise-85">Вправа 8.5</a></h3>
  <p>Використайте рекурсію, щоб намалювати трикутник Серпінського (як показано в елементарному КА Вольфрама у <a href="/cellular-automata#section-cellular-automata">Розділі 7</a>).</p>
  <figure>
    <div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:1800px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;293&#x27; width=&#x27;1800&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#080808;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="./static/cb1517c3931a016e64949f8f8bdde878/0d7b5/08_fractals_19.webp 450w,./static/cb1517c3931a016e64949f8f8bdde878/53f29/08_fractals_19.webp 900w,./static/cb1517c3931a016e64949f8f8bdde878/c96e0/08_fractals_19.webp 1800w" sizes="(min-width: 1800px) 1800px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 1800px) 1800px, 100vw" decoding="async" loading="lazy" data-src="./static/cb1517c3931a016e64949f8f8bdde878/aaac8/08_fractals_19.png" data-srcset="./static/cb1517c3931a016e64949f8f8bdde878/a186e/08_fractals_19.png 450w,./static/cb1517c3931a016e64949f8f8bdde878/0e7f6/08_fractals_19.png 900w,./static/cb1517c3931a016e64949f8f8bdde878/aaac8/08_fractals_19.png 1800w" alt=""/></picture><noscript><picture><source type="image/webp" srcSet="./static/cb1517c3931a016e64949f8f8bdde878/0d7b5/08_fractals_19.webp 450w,./static/cb1517c3931a016e64949f8f8bdde878/53f29/08_fractals_19.webp 900w,./static/cb1517c3931a016e64949f8f8bdde878/c96e0/08_fractals_19.webp 1800w" sizes="(min-width: 1800px) 1800px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 1800px) 1800px, 100vw" decoding="async" loading="lazy" src="./static/cb1517c3931a016e64949f8f8bdde878/aaac8/08_fractals_19.png" srcSet="./static/cb1517c3931a016e64949f8f8bdde878/a186e/08_fractals_19.png 450w,./static/cb1517c3931a016e64949f8f8bdde878/0e7f6/08_fractals_19.png 900w,./static/cb1517c3931a016e64949f8f8bdde878/aaac8/08_fractals_19.png 1800w" alt=""/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div>
    <figcaption></figcaption>
  </figure>
</div>
<h2 id="trees"><a class="heading-link" href="#trees">Дерева</a></h2>
<p>Фрактали, представлені до цього моменту у цьому розділі, були детермінованими: у них немає випадковості й вони завжди дають однаковий результат кожного разу, коли їх запускають. Хоча вони стали чудовим вступом до класичних фрактальних візерунків і методів програмування, що лежать в основі їх малювання, результати виявилися занадто точними, щоб здаватися справді органічними.</p>
<p>Далі у цьому розділі я зроблю на крок ближче до світу природи, розгляну приклад розгалуженого фрактального дерева. Я почну з детермінованої версії. Потім введу елемент випадковості, щоб проілюструвати методи генерації стохастичних (або недетермінованих) фракталів, результат яких може щоразу змінюватися.</p>
<h3 id="the-deterministic-version"><a class="heading-link" href="#the-deterministic-version">Детермінована версія</a></h3>
<p>На малюнку 8.17 показано детермінований набір породжувальних правил для малювання фрактального дерева.</p>
<figure>
  <div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:2304px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;1257&#x27; width=&#x27;2304&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="./static/6a5009639efe564ba4aa8c9f61d80809/21300/08_fractals_20.webp 576w,./static/6a5009639efe564ba4aa8c9f61d80809/9b868/08_fractals_20.webp 1152w,./static/6a5009639efe564ba4aa8c9f61d80809/d07fe/08_fractals_20.webp 2304w" sizes="(min-width: 2304px) 2304px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2304px) 2304px, 100vw" decoding="async" loading="lazy" data-src="./static/6a5009639efe564ba4aa8c9f61d80809/eff68/08_fractals_20.png" data-srcset="./static/6a5009639efe564ba4aa8c9f61d80809/d7a6d/08_fractals_20.png 576w,./static/6a5009639efe564ba4aa8c9f61d80809/f7ab0/08_fractals_20.png 1152w,./static/6a5009639efe564ba4aa8c9f61d80809/eff68/08_fractals_20.png 2304w" alt="Малюнок 8.17: Кожне покоління фрактального дерева із дотриманням породжувальних правил"/></picture><noscript><picture><source type="image/webp" srcSet="./static/6a5009639efe564ba4aa8c9f61d80809/21300/08_fractals_20.webp 576w,./static/6a5009639efe564ba4aa8c9f61d80809/9b868/08_fractals_20.webp 1152w,./static/6a5009639efe564ba4aa8c9f61d80809/d07fe/08_fractals_20.webp 2304w" sizes="(min-width: 2304px) 2304px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2304px) 2304px, 100vw" decoding="async" loading="lazy" src="./static/6a5009639efe564ba4aa8c9f61d80809/eff68/08_fractals_20.png" srcSet="./static/6a5009639efe564ba4aa8c9f61d80809/d7a6d/08_fractals_20.png 576w,./static/6a5009639efe564ba4aa8c9f61d80809/f7ab0/08_fractals_20.png 1152w,./static/6a5009639efe564ba4aa8c9f61d80809/eff68/08_fractals_20.png 2304w" alt="Малюнок 8.17: Кожне покоління фрактального дерева із дотриманням породжувальних правил"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div>
  <figcaption>Малюнок 8.17: Кожне покоління фрактального дерева із дотриманням породжувальних прави л</figcaption>
</figure>
<p>І знову я маю гарний фрактал із рекурсивним визначенням: гілка — це лінія з двома гілками, з’єднаними з нею. Що робить цей фрактал дещо складнішим, ніж попередні, так це використання у правилах фракталу <em>поворотів</em>. Кожна нова гілка повинна повертатися відносно попередньої гілки, яка обертається відносно всіх своїх попередніх гілок. На щастя, p5.js має механізм для відстеження поворотів: <strong>transformations</strong>.</p>
<p>Я вже торкався трансформацій у <a href="/oscillation#section-oscillation">Розділі 3</a>. Це набір функцій, таких як <code>translate()</code>, <code>rotate()</code>, <code>scale()</code>, <code>push()</code> і <code>pop()</code>, які дозволяють змінювати положення, орієнтацію та масштаб фігур у вашій програмі. Функція <code>translate()</code> переміщує систему координат, <code>rotate()</code> обертає її, а <code>push()</code> і <code>pop()</code> допомагають зберегти та відновити поточний стан трансформації. Якщо ви не знайомі з цими функціями, у мене є <a href="https://thecodingtrain.com/transformations" target="_blank" rel="noopener">набір відео про перетворення в p5.js, що доступні на вебсайті Coding Train</a>.</p>
<p>Я почну з малювання однієї гілки, стовбура дерева. Оскільки я збираюся використовувати функцію <code>rotate()</code>, мені потрібно переконатися, що я постійно переміщуюсь вздовж гілок під час малювання. Пам’ятайте, коли ви робите повороти у p5.js, ви завжди обертаєтеся навколо початку координат або точки <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(0, 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span>, тому у випадку з деревом ми маємо завжди переміщувати ці координати відліку на початок наступної гілки, що малюється (еквівалент кінця попередньої гілки). Оскільки гілка починається знизу, мені спочатку потрібно перемістити початкові координати полотна саме туди:</p>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-title function_">translate</span>(width / <span class="hljs-number">2</span>, height);
</code></pre><div class="comment"><p></p></div></div></div>
<div class="avoid-break">
  <p>Потім я можу намалювати стовбур як лінію вгору:</p>
  <div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-title function_">line</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">100</span>);
</code></pre><div class="comment"><p></p></div></div></div>
</div>
<p>Після того, як я намалював лінію, я повинен переміститися в її кінець і зробити поворот під кутом, щоб намалювати наступну гілку, як показано на малюнку 8.18. (Зрештою мені потрібно буде об’єднати те, що я зараз роблю, у рекурсивну функцію, але спочатку я розберуся з окремими кроками.)</p>
<figure>
  <div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:2304px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;671&#x27; width=&#x27;2304&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="./static/c6006a0edfb96bdb0dab3b4e3b09df74/b466a/08_fractals_21.webp 576w,./static/c6006a0edfb96bdb0dab3b4e3b09df74/76066/08_fractals_21.webp 1152w,./static/c6006a0edfb96bdb0dab3b4e3b09df74/f7f48/08_fractals_21.webp 2304w" sizes="(min-width: 2304px) 2304px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2304px) 2304px, 100vw" decoding="async" loading="lazy" data-src="./static/c6006a0edfb96bdb0dab3b4e3b09df74/d01cc/08_fractals_21.png" data-srcset="./static/c6006a0edfb96bdb0dab3b4e3b09df74/203e6/08_fractals_21.png 576w,./static/c6006a0edfb96bdb0dab3b4e3b09df74/95347/08_fractals_21.png 1152w,./static/c6006a0edfb96bdb0dab3b4e3b09df74/d01cc/08_fractals_21.png 2304w" alt="Малюнок 8.18: Процес малювання лінії, переміщення до її кінця та поворот на кут"/></picture><noscript><picture><source type="image/webp" srcSet="./static/c6006a0edfb96bdb0dab3b4e3b09df74/b466a/08_fractals_21.webp 576w,./static/c6006a0edfb96bdb0dab3b4e3b09df74/76066/08_fractals_21.webp 1152w,./static/c6006a0edfb96bdb0dab3b4e3b09df74/f7f48/08_fractals_21.webp 2304w" sizes="(min-width: 2304px) 2304px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2304px) 2304px, 100vw" decoding="async" loading="lazy" src="./static/c6006a0edfb96bdb0dab3b4e3b09df74/d01cc/08_fractals_21.png" srcSet="./static/c6006a0edfb96bdb0dab3b4e3b09df74/203e6/08_fractals_21.png 576w,./static/c6006a0edfb96bdb0dab3b4e3b09df74/95347/08_fractals_21.png 1152w,./static/c6006a0edfb96bdb0dab3b4e3b09df74/d01cc/08_fractals_21.png 2304w" alt="Малюнок 8.18: Процес малювання лінії, переміщення до її кінця та поворот на кут"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div>
  <figcaption>Малюнок 8.18: Процес малювання лінії, зміщення початкових координат до її кінця та поворот на заданий кут</figcaption>
</figure>
<p>Ось код для процесу, зображеного на малюнку 8.18. Я використовую кут у 30 градусів або <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mi mathvariant="normal">/</mi><mn>6</mn></mrow><annotation encoding="application/x-tex">\pi/6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="mord">/6</span></span></span></span></span> радіан:</p>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-title function_">translate</span>(<span class="hljs-number">0</span>, -<span class="hljs-number">100</span>);
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript"><span class="hljs-title function_">rotate</span>(<span class="hljs-variable constant_">PI</span> / <span class="hljs-number">6</span>);
<span class="hljs-title function_">line</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">100</span>);
</code></pre><div class="comment"><p>π поділене на 6 є еквівалентом 30°.</p></div></div></div>
<p>Тепер, коли у мене є гілка праворуч, мені потрібна гілка ліворуч (див. малюнок 8.19). Для цього я маю використати функцію <code>push()</code> , щоб зберегти стан трансформації перед поворотом і малюванням правої гілки. Тоді, після малювання правої гілки, я зможу викликати функцію <code>pop()</code> , щоб відновити цей стан, повернувши себе у потрібне попереднє положення для нового повороту та малювання лівої гілки.</p>
<figure>
  <div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:2304px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;678&#x27; width=&#x27;2304&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="./static/09c0ab768af743c5cb5184c663a86ba3/c2585/08_fractals_22.webp 576w,./static/09c0ab768af743c5cb5184c663a86ba3/ed75c/08_fractals_22.webp 1152w,./static/09c0ab768af743c5cb5184c663a86ba3/a824c/08_fractals_22.webp 2304w" sizes="(min-width: 2304px) 2304px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2304px) 2304px, 100vw" decoding="async" loading="lazy" data-src="./static/09c0ab768af743c5cb5184c663a86ba3/b2088/08_fractals_22.png" data-srcset="./static/09c0ab768af743c5cb5184c663a86ba3/a552e/08_fractals_22.png 576w,./static/09c0ab768af743c5cb5184c663a86ba3/068da/08_fractals_22.png 1152w,./static/09c0ab768af743c5cb5184c663a86ba3/b2088/08_fractals_22.png 2304w" alt="Малюнок 8.19: Після “повернення” назад нова гілка направляється ліворуч"/></picture><noscript><picture><source type="image/webp" srcSet="./static/09c0ab768af743c5cb5184c663a86ba3/c2585/08_fractals_22.webp 576w,./static/09c0ab768af743c5cb5184c663a86ba3/ed75c/08_fractals_22.webp 1152w,./static/09c0ab768af743c5cb5184c663a86ba3/a824c/08_fractals_22.webp 2304w" sizes="(min-width: 2304px) 2304px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2304px) 2304px, 100vw" decoding="async" loading="lazy" src="./static/09c0ab768af743c5cb5184c663a86ba3/b2088/08_fractals_22.png" srcSet="./static/09c0ab768af743c5cb5184c663a86ba3/a552e/08_fractals_22.png 576w,./static/09c0ab768af743c5cb5184c663a86ba3/068da/08_fractals_22.png 1152w,./static/09c0ab768af743c5cb5184c663a86ba3/b2088/08_fractals_22.png 2304w" alt="Малюнок 8.19: Після “повернення” назад нова гілка направляється ліворуч"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div>
  <figcaption>Малюнок 8.19: Після “повернення” назад нова гілка направляється ліворуч</figcaption>
</figure>
<div class="avoid-break">
  <p>Ось весь код разом:</p>
  <div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-title function_">translate</span>(width / <span class="hljs-number">2</span>, height);
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript"><span class="hljs-title function_">line</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">100</span>);
</code></pre><div class="comment"><p>Основний стовбур.</p></div></div><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-title function_">translate</span>(<span class="hljs-number">0</span>, -<span class="hljs-number">100</span>);
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript"><span class="hljs-title function_">push</span>();
<span class="hljs-title function_">rotate</span>(<span class="hljs-variable constant_">PI</span> / <span class="hljs-number">6</span>);
<span class="hljs-title function_">line</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">100</span>);
<span class="hljs-title function_">pop</span>();
</code></pre><div class="comment"><p>Відгалуження гілки направо.</p></div></div><div class="pair split"><pre><code class="hljs code language-javascript"><span class="hljs-title function_">rotate</span>(-<span class="hljs-variable constant_">PI</span> / <span class="hljs-number">6</span>);
<span class="hljs-title function_">line</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">100</span>);
</code></pre><div class="comment"><p>Відгалуження гілки наліво.</p></div></div></div>
</div>
<p>Уявіть кожен виклик функції <code>line()</code> як гілку і ви зможете зрозуміти, як цей код імплементує процес розгалуження лінії, яка має дві лінії, з’єднані з її кінцями. Я міг би продовжувати додавати нові й нові виклики функції <code>line()</code> для все нових і нових розгалужень, але як і з множиною Кантора та кривою Коха, мій код незабаром став би неймовірно складним і громіздким. Замість цього я використаю код, який вже написав, як основу для функції <code>branch()</code>, замінивши другий і третій виклики функції <code>line()</code> рекурсивними викликами функції <code>branch()</code> всередині самої себе:</p>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">branch</span>(<span class="hljs-params"></span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">line</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">100</span>);
</code></pre><div class="comment"><p>Намалюємо гілку.</p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">translate</span>(<span class="hljs-number">0</span>, -<span class="hljs-number">100</span>);
</code></pre><div class="comment"><p>Перемістимо координати відліку у її кінець.</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">push</span>();
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">rotate</span>(<span class="hljs-variable constant_">PI</span> / <span class="hljs-number">6</span>);
  <span class="hljs-title function_">branch</span>();
</code></pre><div class="comment"><p>Повернемо праворуч і викличемо нове розгалуження.</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">pop</span>();
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">push</span>();
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">rotate</span>(-<span class="hljs-variable constant_">PI</span> / <span class="hljs-number">6</span>);
  <span class="hljs-title function_">branch</span>();
</code></pre><div class="comment"><p>Повернемо ліворуч і викличемо нове розгалуження.</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">pop</span>();
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">}
</code></pre><div class="comment"><p></p></div></div></div>
<p>Зверніть увагу, що я використовую функції <code>push()</code> і <code>pop()</code> навколо кожної пари <code>rotate()</code> та <code>branch()</code>. Це одне з тих елегантних програмних рішень, яке виглядає як магія. Перед кожним наступним викликом функції <code>branch()</code>, програмі потрібен момент, щоб запам’ятати початкову позицію цієї гілки, щоб вона могла повернутися до неї пізні ше. Якщо ви на мить уявите себе на місці p5.js і спробуєте простежити за рекурсивною функцією з олівцем та папером у руках, то помітите, що спочатку малюєте всі гілки праворуч. У самому кінці правої сторони функція <code>pop()</code> поверне вас назад уздовж усіх намальованих гілок, щоб ви могли намалювати гілки ліворуч.</p>
<div data-type="exercise" class="callout">
  <h3 id="exercise-86"><a class="heading-link" href="#exercise-86">Вправа 8.6</a></h3>
  <div class="half-width-right">
    <figure>
      <div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:500px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;393&#x27; width=&#x27;500&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="./static/4128db18ec6c0230c6b9e1575ca0b329/df63e/08_fractals_23.webp 125w,./static/4128db18ec6c0230c6b9e1575ca0b329/957b8/08_fractals_23.webp 250w,./static/4128db18ec6c0230c6b9e1575ca0b329/4e359/08_fractals_23.webp 500w" sizes="(min-width: 500px) 500px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 500px) 500px, 100vw" decoding="async" loading="lazy" data-src="./static/4128db18ec6c0230c6b9e1575ca0b329/e68ae/08_fractals_23.png" data-srcset="./static/4128db18ec6c0230c6b9e1575ca0b329/ca101/08_fractals_23.png 125w,./static/4128db18ec6c0230c6b9e1575ca0b329/78266/08_fractals_23.png 250w,./static/4128db18ec6c0230c6b9e1575ca0b329/e68ae/08_fractals_23.png 500w" alt=""/></picture><noscript><picture><source type="image/webp" srcSet="./static/4128db18ec6c0230c6b9e1575ca0b329/df63e/08_fractals_23.webp 125w,./static/4128db18ec6c0230c6b9e1575ca0b329/957b8/08_fractals_23.webp 250w,./static/4128db18ec6c0230c6b9e1575ca0b329/4e359/08_fractals_23.webp 500w" sizes="(min-width: 500px) 500px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 500px) 500px, 100vw" decoding="async" loading="lazy" src="./static/4128db18ec6c0230c6b9e1575ca0b329/e68ae/08_fractals_23.png" srcSet="./static/4128db18ec6c0230c6b9e1575ca0b329/ca101/08_fractals_23.png 125w,./static/4128db18ec6c0230c6b9e1575ca0b329/78266/08_fractals_23.png 250w,./static/4128db18ec6c0230c6b9e1575ca0b329/e68ae/08_fractals_23.png 500w" alt=""/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div>
      <figcaption></figcaption>
    </figure>
  </div>
  <p>Дотримуйтеся рекурсивного алгоритму малювання гілок і пронумеруйте їх на діаграмі у тому порядку, в якому кожну з них малює p5.js.</p>
</div>
<p>Можливо ви помітили, що написана рекурсивна функція має серйозну проблему: вона не має умови виходу, тому застрягне у нескінченних рекурсивних викликах самої себе. Крім того, гілки дерева повинні ставати коротшими на кожному рівні, але наразі я жорстко закодував довжину кожної гілки у 100 пікселів. Розв&#x27;язки цих двох проблем взаємопов’язані. Якщо гілки зменшуються від одного покоління до іншого, я можу змусити функцію припинити рекурсію, коли гілки стануть занадто короткими:</p>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair split"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">branch</span>(<span class="hljs-params">len</span>) {
</code></pre><div class="comment"><p>Тепер кожна гілка отримує свою довжину через аргумент.</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">line</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, -len);
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">translate</span>(<span class="hljs-number">0</span>, -len);
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  len *= <span class="hljs-number">0.67</span>;
</code></pre><div class="comment"><p>Довжина кожної гілки зменшується на третину.</p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">if</span> (len &gt; <span class="hljs-number">2</span>) {
</code></pre><div class="comment"><p>Умова виходу із рекурсії!</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">    <span class="hljs-title function_">push</span>();
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">    <span class="hljs-title function_">rotate</span>(angle);
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">    <span class="hljs-title function_">branch</span>(len);
</code></pre><div class="comment"><p>Подальші виклики функції branch() містять аргумент length.</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">    <span class="hljs-title function_">pop</span>();
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">    <span class="hljs-title function_">push</span>();
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">    <span class="hljs-title function_">rotate</span>(-angle);
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">    <span class="hljs-title function_">branch</span>(len);
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">    <span class="hljs-title function_">pop</span>();
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  }
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">}
</code></pre><div class="comment"><p></p></div></div></div>
<p>Я також включив для кута змінну <code>angle</code>. У готовому прикладі кут контролюється позицією змінної <code>mouseX</code>.</p>
<div data-type="example">
  <h3 id="example-86-a-recursive-tree"><a class="heading-link" href="#example-86-a-recursive-tree">Приклад 8.6: Рекурсивне дерево</a></h3>
  <figure>
    <div class="not-prose clear-both my-4 overflow-hidden rounded border bg-gray-100" style="max-width:1152px"><div class="relative overflow-hidden rounded-t bg-white"><!-- <div class="absolute left-[50%] top-[50%] -translate-x-[50%] -translate-y-[50%] ">Loading sketch ...</div> --><iframe class="w-full border-none transition-opacity opacity-1000" style="aspect-ratio:2.667" loading="lazy" src="./examples/08_fractals/8_6_tree"></iframe></div><div class="flex items-center justify-between border-t"><div class="flex"><button class="flex items-center border-r px-2.5 py-1.5 text-sm hover:bg-gray-200"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true" class="h-[15px] w-[15px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg><span class="ml-1.5">Reset</span></button><button class="flex items-center border-r px-2.5 py-1.5 text-sm hover:bg-gray-200"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span class="ml-1">Pause</span></button></div><a href="https://editor.p5js.org/natureofcode/sketches/DaINq2A85" target="_blank" rel="noreferrer" class="flex items-center px-2.5 text-[0.8rem] hover:underline">Open in Web Editor<svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="ml-1 text-gray-500" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></a></div></div>
    <figcaption></figcaption>
  </figure>
</div>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">let</span> angle;
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">createCanvas</span>(<span class="hljs-number">640</span>, <span class="hljs-number">240</span>);
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">}
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">draw</span>(<span class="hljs-params"></span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">background</span>(<span class="hljs-number">255</span>);
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  angle = <span class="hljs-title function_">map</span>(mouseX, <span class="hljs-number">0</span>, width, <span class="hljs-number">0</span>, <span class="hljs-variable constant_">HALF_PI</span>);
</code></pre><div class="comment"><p>Масштабування кута у діапазоні від 0° до 90° (HALF_PI) відповідно до значення mouseX.</p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">translate</span>(width / <span class="hljs-number">2</span>, height);
  <span class="hljs-title function_">stroke</span>(<span class="hljs-number">0</span>);
  <span class="hljs-title function_">strokeWeight</span>(<span class="hljs-number">2</span>);
  <span class="hljs-title function_">branch</span>(<span class="hljs-number">80</span>);
</code></pre><div class="comment"><p>Початок рекурсивного дерева з нижньої частини полотна.</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">}
</code></pre><div class="comment"><p></p></div></div></div>
<p>Рекурсивна функція <code>branch()</code> забезпечує простий і елегантний спосіб малювання дерева з малою кількістю рядків коду. Однак такий підхід обмежує потенціал для анімації. Використовуючи підхід, застосований у кривій Коха і зберігаючи кожен сегмент як об’єкт у масиві, ви можете розкрити творчі способи для анімації росту дерева або навіть застосувати до гілок фізику!</p>
<div data-type="exercise" class="callout">
  <h3 id="exercise-87"><a class="heading-link" href="#exercise-87">Вправа 8.7</a></h3>
  <p>Змінюйте товщину кожної гілки за допомогою функції <code>strokeWeight()</code>. Зробіть стовбур товстим, а кожну наступну гілку то ншою.</p>
  <figure>
    <div class="not-prose clear-both my-4 overflow-hidden rounded border bg-gray-100" style="max-width:1152px"><div class="relative overflow-hidden rounded-t bg-white"><!-- <div class="absolute left-[50%] top-[50%] -translate-x-[50%] -translate-y-[50%] ">Loading sketch ...</div> --><iframe class="w-full border-none transition-opacity opacity-1000" style="aspect-ratio:2.667" loading="lazy" src="./examples/08_fractals/exercise_8_7_branch_thickness"></iframe></div><div class="flex items-center justify-between border-t"><div class="flex"><button class="flex items-center border-r px-2.5 py-1.5 text-sm hover:bg-gray-200"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true" class="h-[15px] w-[15px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg><span class="ml-1.5">Reset</span></button><button class="flex items-center border-r px-2.5 py-1.5 text-sm hover:bg-gray-200"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span class="ml-1">Pause</span></button></div><a href="https://editor.p5js.org/natureofcode/sketches/x_ZEtNJKb" target="_blank" rel="noreferrer" class="flex items-center px-2.5 text-[0.8rem] hover:underline">Open in Web Editor<svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="ml-1 text-gray-500" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></a></div></div>
    <figcaption></figcaption>
  </figure>
</div>
<div data-type="exercise" class="callout">
  <h3 id="exercise-88"><a class="heading-link" href="#exercise-88">Вправа 8.8</a></h3>
  <p>Створіть дерево, використовуючи клас <code>Branch</code> і масив для збереження гілок. (Підказка: для відстеження напрямку і довжини гілок, можна використовуючи векторну математику замість трансформацій p5.js.) Чи зможете ви анімувати ріст дерева? А як щодо малювання листя на кінцях гілок?</p>
  <figure>
    <div class="not-prose clear-both my-4 overflow-hidden rounded border bg-gray-100" style="max-width:1152px"><div class="relative overflow-hidden rounded-t bg-white"><!-- <div class="absolute left-[50%] top-[50%] -translate-x-[50%] -translate-y-[50%] ">Loading sketch ...</div> --><iframe class="w-full border-none transition-opacity opacity-1000" style="aspect-ratio:2.667" loading="lazy" src="./examples/08_fractals/exercise_8_8_branch_objects_animation"></iframe></div><div class="flex items-center justify-between border-t"><div class="flex"><button class="flex items-center border-r px-2.5 py-1.5 text-sm hover:bg-gray-200"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true" class="h-[15px] w-[15px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg><span class="ml-1.5">Reset</span></button><button class="flex items-center border-r px-2.5 py-1.5 text-sm hover:bg-gray-200"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span class="ml-1">Pause</span></button></div><a href="https://editor.p5js.org/natureofcode/sketches/mR4_GpQS-" target="_blank" rel="noreferrer" class="flex items-center px-2.5 text-[0.8rem] hover:underline">Open in Web Editor<svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="ml-1 text-gray-500" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></a></div></div>
    <figcaption></figcaption>
  </figure>
</div>
<h3 id="the-stochastic-version"><a class="heading-link" href="#the-stochastic-version">Стохастична версія</a></h3>
<p>На перший погляд (і під прямим кутом) може здатися, що у попередньому прикладі я намалював доволі переконливе дерево, але при ближчому розгляді результат виходить занадто ідеальним. Подивіться на справжнє дерево ззовні й ви помітите, що довжина гілок і кути різняться від гілки до гілки, не кажучи вже про те, що не всі гілки розходяться рівно на дві менші гілки. Фрактальні дерева є чудовим прикладом того, як додавання нотки випадковості може зробити кінцевий результат більш природним. Ця частинка випадковості також перетворює фрактал із детермінованого на стохастичний — кожний конкретний результат буде відрізнятися від малюнка до малюнка, зберігаючи при цьому загальні характеристики розгалуженої деревоподібної структури.</p>
<p>По-перше, як щодо рандомізації кута для кожної гілки? Це досить легко зробити, просто використавши функцію <code>random()</code>:</p>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair split"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">let</span> angle = <span class="hljs-title function_">random</span>(<span class="hljs-number">0</span>, <span class="hljs-variable constant_">PI</span> / <span class="hljs-number">3</span>);
</code></pre><div class="comment"><p>Виберемо випадковий кут від 0 до π/3 для кожної гілки.</p></div></div></div>
<p>В оригінальному прикладі функція <code>branch()</code> завжди викликала себе двічі. Тепер для додаткової різноманітності я замість цього виберу випадкову кількість гілок (кожна з випадковим кутом) для кожної гілки.</p>
<div data-type="example">
  <h3 id="example-87-a-stochastic-tree"><a class="heading-link" href="#example-87-a-stochastic-tree">Приклад 8.7: Стохастичне дерево</a></h3>
  <figure>
    <div class="not-prose clear-both my-4 overflow-hidden rounded border bg-gray-100" style="max-width:1152px"><div class="relative overflow-hidden rounded-t bg-white"><!-- <div class="absolute left-[50%] top-[50%] -translate-x-[50%] -translate-y-[50%] ">Loading sketch ...</div> --><iframe class="w-full border-none transition-opacity opacity-1000" style="aspect-ratio:2.667" loading="lazy" src="./examples/08_fractals/8_7_stochastic_tree"></iframe></div><div class="flex items-center justify-between border-t"><div class="flex"><button class="flex items-center border-r px-2.5 py-1.5 text-sm hover:bg-gray-200"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true" class="h-[15px] w-[15px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg><span class="ml-1.5">Reset</span></button><button class="flex items-center border-r px-2.5 py-1.5 text-sm hover:bg-gray-200"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span class="ml-1">Pause</span></button></div><a href="https://editor.p5js.org/natureofcode/sketches/xh0kdMTP4" target="_blank" rel="noreferrer" class="flex items-center px-2.5 text-[0.8rem] hover:underline">Open in Web Editor<svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="ml-1 text-gray-500" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></a></div></div>
    <figcaption></figcaption>
  </figure>
</div>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">branch</span>(<span class="hljs-params">length</span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">line</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, -length);
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">translate</span>(<span class="hljs-number">0</span>, -length);
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  length *= <span class="hljs-number">0.67</span>;
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">if</span> (length &gt; <span class="hljs-number">2</span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">    <span class="hljs-keyword">let</span> n = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title function_">random</span>(<span class="hljs-number">1</span>, <span class="hljs-number">4</span>));
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) {
</code></pre><div class="comment"><p>Випадкова кількість гілок.</p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">      <span class="hljs-keyword">let</span> angle = <span class="hljs-title function_">random</span>(-<span class="hljs-variable constant_">PI</span> / <span class="hljs-number">2</span>, <span class="hljs-variable constant_">PI</span> / <span class="hljs-number">2</span>);
      <span class="hljs-title function_">push</span>();
      <span class="hljs-title function_">rotate</span>(angle);
      <span class="hljs-title function_">branch</span>(length);
      <span class="hljs-title function_">pop</span>();
</code></pre><div class="comment"><p>Випадковий кут.</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">    }
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  }
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">}
</code></pre><div class="comment"><p></p></div></div></div>
<p>Приклад 8.7 демонструє використання випадковості для кутів і кількості гілок, але, можливо, він заходить занадто далеко: отримані дерева все ще не виглядають особливо органічними. Для більш природного вигляду дерева ви можете спробувати трохи обмежити діапазон випадкових кутів, або використати шум Перліна для більш поступових змін кутів.</p>
<div data-type="exercise" class="callout">
  <h3 id="exercise-89"><a class="heading-link" href="#exercise-89">Вправа 8.9</a></h3>
  <p>Встановіть кути гілок дерева відповідно до значень шуму Перліна. Налаштуйте значення шуму з часом, щоб анімувати дерево. Спробуйте надати дереву такий вигляд, ніби на нього дме вітер.</p>
</div>
<div data-type="exercise" class="callout">
  <h3 id="exercise-810"><a class="heading-link" href="#exercise-810">Вправа 8.10</a></h3>
  <p>Використайте бібліотеку Toxiclibs.js для симуляції фізики дерева. Кожна гілка дерева може бути двома частинками, з&#x27;єднаними пружиною. Як змусити дерево вистояти й не впасти?</p>
</div>
<h2 id="l-systems"><a class="heading-link" href="#l-systems">L-системи</a></h2>
<p>У 1968 році угорський бот анік Арістід Лінденмаєр розробив засновану на граматиці систему для моделювання моделей росту рослин. Ця система використовує текстові символи та певний набір правил для створення шаблонів, подібно до того, як граматика мови визначає правила побудови речень зі слів. Ця техніка, відома як <strong>L-система</strong> (скорочення від <strong>Lindenmayer system</strong>), може бути використана для генерації рекурсивних фрактальних візерунків, продемонстрованих у цьому розділі. L-системи також цінні, оскільки вони забезпечують механізм використання простих символів для управління фрактальними структурами, які вимагають складних і багатогранних правил створення.</p>
<p>Імплементація L-системи у p5.js вимагає роботи з рекурсією, трансформаціями та рядками тексту. У цьому розділі вже розглядалися рекурсії й перетворення, але використання рядків є новим. Ось короткий фрагмент коду, який демонструє три аспекти роботи з текстом, важливих для L-систем — створення, конкатенація та повторення рядків:</p>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair split"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">let</span> message1 = <span class="hljs-string">&quot;Hello!&quot;</span>;
</code></pre><div class="comment"><p>Рядок створюється як текст між лапками (одинарними або подвійними).</p></div></div><div class="pair split"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">let</span> message2 = message1 + <span class="hljs-string">&quot; Goodbye!&quot;</span>;
</code></pre><div class="comment"><p>Рядки можна об’єднувати (конкатенувати) за допомогою оператора плюс. Змінна message2 отримає значення &quot;Hello Goodbye!&quot;</p></div></div><div class="pair split"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; message.<span class="hljs-property">length</span>; i++) {
</code></pre><div class="comment"><p>Довжина рядка зберігається у властивості length.</p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">let</span> character = message.<span class="hljs-title function_">charAt</span>(i);
</code></pre><div class="comment"><p>Доступ до окремих символів можна отримати за допомогою індексу, як у масиві! Я використовую метод charAt(i) замість [i].</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">}
</code></pre><div class="comment"><p></p></div></div></div>
<p>L-система складається з трьох основних компонентів:</p>
<ul>
  <li><strong>Алфавіт.</strong> Алфавіт L-системи містить допустимі символи, які можна включити. Наприклад, я міг би сказати, що алфавіт це <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>B</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">ABC</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.07153em">BC</span></span></span></span></span>, тобто будь-яке валідне “речення” (рядок символів) у L-системі може містити лише ці три символи.</li>
  <li><strong>Аксіома.</strong> Аксіома — це речення (створене за допомогою символів алфавіту), яке описує початковий стан системи. Наприклад, для алфавіту <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>B</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">ABC</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.07153em">BC</span></span></span></span></span> можливою аксіомою може бути рядок <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>A</mi><mi>A</mi></mrow><annotation encoding="application/x-tex">AAA</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">AAA</span></span></span></span></span> або <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span></span>, або <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>C</mi><mi>B</mi><mi>A</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">ACBAB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em">CB</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span></span>.</li>
  <li><strong>Правила.</strong> Правила створення L-системи описують способи трансформації речення. Правила застосовуються рекурсивно, починаючи з аксіоми, генеруючи нові речення знову і знову. Правило L-системи включає два речення: <em>попереднє</em> і <em>наступне</em>. Наприклад, правило <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>→</mo><mi>A</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">A → AB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span></span> означає, що де б у реченні не зустрічалося <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span></span></span></span></span> (попередник), у наступному поколінні його слід замінити на <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">AB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span></span> (наступника).</li>
</ul>
<p>Я почну з простої L-системи. Фактично, це оригінальна L-система Лінденмаєра, яка моделює ріст водоростей. Ось її компоненти:</p>
<table><tbody><tr><td style="width:120px">Алфавіт</td><td><span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span></span></span></span></span>, <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span></span></td></tr><tr><td>Аксіома</td><td><span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span></span></span></span></span></td></tr><tr><td>Правила</td><td><span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>→</mo><mi>A</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">A → AB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span></span><br/><span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>→</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">B → A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05017em">B</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span></span></span></span></span></td></tr></tbody></table>
<div class="half-width-right">
  <figure>
    <div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:1152px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;838.0000000000001&#x27; width=&#x27;1152&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="./static/64ad4c1daee534b206d5338ba808e350/08c6c/08_fractals_24.webp 288w,./static/64ad4c1daee534b206d5338ba808e350/ad8b9/08_fractals_24.webp 576w,./static/64ad4c1daee534b206d5338ba808e350/5ed4d/08_fractals_24.webp 1152w" sizes="(min-width: 1152px) 1152px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 1152px) 1152px, 100vw" decoding="async" loading="lazy" data-src="./static/64ad4c1daee534b206d5338ba808e350/feac1/08_fractals_24.png" data-srcset="./static/64ad4c1daee534b206d5338ba808e350/6f596/08_fractals_24.png 288w,./static/64ad4c1daee534b206d5338ba808e350/f542a/08_fractals_24.png 576w,./static/64ad4c1daee534b206d5338ba808e350/feac1/08_fractals_24.png 1152w" alt="Малюнок 8.20: Приклад перетворень L-системи за певним правилом"/></picture><noscript><picture><source type="image/webp" srcSet="./static/64ad4c1daee534b206d5338ba808e350/08c6c/08_fractals_24.webp 288w,./static/64ad4c1daee534b206d5338ba808e350/ad8b9/08_fractals_24.webp 576w,./static/64ad4c1daee534b206d5338ba808e350/5ed4d/08_fractals_24.webp 1152w" sizes="(min-width: 1152px) 1152px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 1152px) 1152px, 100vw" decoding="async" loading="lazy" src="./static/64ad4c1daee534b206d5338ba808e350/feac1/08_fractals_24.png" srcSet="./static/64ad4c1daee534b206d5338ba808e350/6f596/08_fractals_24.png 288w,./static/64ad4c1daee534b206d5338ba808e350/f542a/08_fractals_24.png 576w,./static/64ad4c1daee534b206d5338ba808e350/feac1/08_fractals_24.png 1152w" alt="Малюнок 8.20: Приклад перетворень L-системи за певним правилом"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div>
    <figcaption>Малюнок 8.20: Приклад перетворень L-системи за певним правилом</figcaption>
  </figure>
</div>
<p>L-система має алфавіт із двох символів і два простих правила: замінити <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span></span></span></span></span> на <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">AB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span></span> і замінити <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span></span> на <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span></span></span></span></span>. Як і у випадку з рекурсивними фрактальними фігурами, я можу вважати кожне наступне застосування правил <span style="white-space:nowrap">L-системи</span> поколінням. Покоління 0, за визначенням, є аксіомою (тут це <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span></span></span></span></span>), і кожне наступне покоління показує результат застосування породжувальних правил до поточного покоління. На малюнку 8.20 показано кілька поколінь розвитку цієї <span style="white-space:nowrap">L-системи</span>.</p>
<p>Як я можу реалізувати цю L-систему за допомогою коду? Я почну зі збереження рядка, що містить аксіому, у змінній. Я назву змінну <code>current</code>, оскільки вона завжди зберігатиме поточне покоління (починаючи з аксіоми):</p>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">let</span> current = <span class="hljs-string">&quot;A&quot;</span>;
</code></pre><div class="comment"><p></p></div></div></div>
<p>Знову ж таки, як і у випадку з Грою Життя та кривою Коха, тепер мені потрібен окремий рядок для наступного покоління:</p>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">let</span> next = <span class="hljs-string">&quot;&quot;</span>;
</code></pre><div class="comment"><p></p></div></div></div>
<p>Тепер настав час застосувати правила генерації до рядка <code>current</code> і записати результати до рядка <code>next</code>:</p>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; current.<span class="hljs-property">length</span>; i++) {
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">let</span> c = current.<span class="hljs-title function_">charAt</span>(i);
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">if</span> (c === <span class="hljs-string">&quot;A&quot;</span>) {
</code></pre><div class="comment"><p>Породжувальне правило: A → AB.</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">    next += <span class="hljs-string">&quot;AB&quot;</span>;
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (c === <span class="hljs-string">&quot;B&quot;</span>) {
</code></pre><div class="comment"><p>Породжувальне правило: B → A.</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">    next += <span class="hljs-string">&quot;A&quot;</span>;
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  }
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">}
</code></pre><div class="comment"><p></p></div></div></div>
<p>Після завершення циклу <code>for</code>, значення змінної <code>current</code> присвоюється у змінну <code>next</code>:</p>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript">current = next;
</code></pre><div class="comment"><p></p></div></div></div>
<p>Щоб переконатися, що цей код працює, я запакую його у функцію під назвою <code>generate()</code> і використаю цикл для кількох її послідовних викликів, малюючи поточний рядок на полотні.</p>
<div data-type="example">
  <h3 id="example-88-simple-l-system-sentence-generation"><a class="heading-link" href="#example-88-simple-l-system-sentence-generation">Приклад 8.8: Проста генерація речень L-системи</a></h3>
  <figure>
    <div class="not-prose clear-both my-4 overflow-hidden rounded border bg-gray-100" style="max-width:1152px"><div class="relative overflow-hidden rounded-t bg-white"><!-- <div class="absolute left-[50%] top-[50%] -translate-x-[50%] -translate-y-[50%] ">Loading sketch ...</div> --><iframe class="w-full border-none transition-opacity opacity-1000" style="aspect-ratio:2.667" loading="lazy" src="./examples/08_fractals/8_8_l_system_string_only"></iframe></div><div class="flex items-center justify-between border-t"><div class="flex"><button class="flex items-center border-r px-2.5 py-1.5 text-sm hover:bg-gray-200"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true" class="h-[15px] w-[15px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg><span class="ml-1.5">Reset</span></button><button class="flex items-center border-r px-2.5 py-1.5 text-sm hover:bg-gray-200"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span class="ml-1">Pause</span></button></div><a href="https://editor.p5js.org/natureofcode/sketches/H_4SeFV3H" target="_blank" rel="noreferrer" class="flex items-center px-2.5 text-[0.8rem] hover:underline">Open in Web Editor<svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="ml-1 text-gray-500" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></a></div></div>
    <figcaption></figcaption>
  </figure>
</div>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair split"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">let</span> current = <span class="hljs-string">&quot;A&quot;</span>;
</code></pre><div class="comment"><p>Почнемо з аксіоми.</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">createCanvas</span>(<span class="hljs-number">640</span>, <span class="hljs-number">160</span>);
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">background</span>(<span class="hljs-number">255</span>);
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">noLoop</span>();
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">9</span>; i++) {
    <span class="hljs-title function_">generate</span>();
</code></pre><div class="comment"><p>Пройдемо дев&#x27;ять поколінь.</p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">    <span class="hljs-title function_">textSize</span>(<span class="hljs-number">16</span>);
    <span class="hljs-title function_">textFont</span>(<span class="hljs-string">&quot;courier&quot;</span>);
    <span class="hljs-title function_">text</span>(i + <span class="hljs-string">&quot;: &quot;</span> + current, <span class="hljs-number">4</span>, <span class="hljs-number">20</span> + i * <span class="hljs-number">16</span>);
</code></pre><div class="comment"><p>Відтворимо текст на полотні.</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  }
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">}
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">generate</span>(<span class="hljs-params"></span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">let</span> next = <span class="hljs-string">&quot;&quot;</span>;
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; current.<span class="hljs-property">length</span>; i++) {
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">    <span class="hljs-keyword">let</span> c = current.<span class="hljs-title function_">charAt</span>(i);
</code></pre><div class="comment"><p>Для кожного символу поточного речення...</p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">    <span class="hljs-keyword">if</span> (c === <span class="hljs-string">&quot;A&quot;</span>) {
      next += <span class="hljs-string">&quot;AB&quot;</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (c === <span class="hljs-string">&quot;B&quot;</span>) {
      next += <span class="hljs-string">&quot;A&quot;</span>;
    }
</code></pre><div class="comment"><p>...застосуємо породжувальні правила: A → AB, B → A.</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  }
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  current = next;
</code></pre><div class="comment"><p>Збережемо покоління next.</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">}
</code></pre><div class="comment"><p></p></div></div></div>
<p>Прямо зараз ви можете подумати: “Це все дуже цікаво, але в чому саме сенс?  Зрештою, хіба цей розділ не має бути про <em>малювання</em> фрактальних візерунків? Я бачу, як рекурсивна природа структури речень L-системи пов’язана з рекурсивною природою фракталів, але як саме це візуально моделює ріст рослин? Наскільки я знаю, немає жодної рослини, яка дає паростки із літер <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span></span></span></span></span> і <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span></span>”.</p>
<p>Досі я залишив недомовленим те, що в ці речення L-системи вбудовано інструкції для малювання, завдяки чому Лінденмаєр зміг перекласти рядки символів в органічні структури рослин. Щоб побачити як це працює, ось інший приклад системи:</p>
<table><tbody><tr><td style="width:120px">Алфавіт</td><td><span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span></span></span></span></span>, <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span></span></td></tr><tr><td>Аксіома</td><td><span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span></span></span></span></span></td></tr><tr><td>Правила</td><td><span style="white-space:pre-wrap"><span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>→</mo><mi>A</mi><mi>B</mi><mi>A</mi></mrow><annotation encoding="application/x-tex">A → ABA</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em">B</span><span class="mord mathnormal">A</span></span></span></span></span>
<span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>→</mo><mi>B</mi><mi>B</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">B → BBB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05017em">B</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05017em">BBB</span></span></span></span></span></span></td></tr></tbody></table>
<div class="avoid-break">
  <p>Ось як ця L-система змінюється протягом кількох поколінь:</p>
  <table><tbody><tr><td style="width:120px">Покоління 0</td><td><span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span></span></span></span></span></td></tr><tr><td>Покоління 1</td><td><span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>B</mi><mi>A</mi></mrow><annotation encoding="application/x-tex">ABA</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em">B</span><span class="mord mathnormal">A</span></span></span></span></span></td></tr><tr><td>Покоління 2</td><td><span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>B</mi><mi>A</mi><mi>B</mi><mi>B</mi><mi>B</mi><mi>A</mi><mi>B</mi><mi>A</mi></mrow><annotation encoding="application/x-tex">ABABBBABA</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em">B</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em">BBB</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em">B</span><span class="mord mathnormal">A</span></span></span></span></span></td></tr><tr><td>Покоління 3</td><td><span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>B</mi><mi>A</mi><mi>B</mi><mi>B</mi><mi>B</mi><mi>A</mi><mi>B</mi><mi>A</mi><mi>B</mi><mi>B</mi><mi>B</mi><mi>B</mi><mi>B</mi><mi>B</mi><mi>B</mi><mi>B</mi><mi>B</mi><mi>A</mi><mi>B</mi><mi>A</mi><mi>B</mi><mi>B</mi><mi>B</mi><mi>A</mi><mi>B</mi><mi>A</mi></mrow><annotation encoding="application/x-tex">ABABBBABABBBBBBBBBABABBBABA</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em">B</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em">BBB</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em">B</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em">BBBBBBBBB</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em">B</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em">BBB</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em">B</span><span class="mord mathnormal">A</span></span></span></span></span></td></tr></tbody></table>
</div>
<p>Щоб перетворити це на малюнок, я перекладу алфавіт системи таким чином:</p>
<table><tbody><tr><td style="width:50px"><span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span></span></span></span></span></td><td>Проводимо лінію вперед.</td></tr><tr><td><span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span></span></td><td>Рухаємося вперед (без малювання лінії).</td></tr></tbody></table>
<p>Озброївшись цим перекладом, я можу сприймати речення кожного поколінн я як інструкцію для малювання. На малюнку 8.21 показано результат.</p>
<figure>
  <div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:2304px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;665&#x27; width=&#x27;2304&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="./static/9618d5fdc8e5eb544b96e636d53cf813/2814d/08_fractals_25.webp 576w,./static/9618d5fdc8e5eb544b96e636d53cf813/5a019/08_fractals_25.webp 1152w,./static/9618d5fdc8e5eb544b96e636d53cf813/94d4f/08_fractals_25.webp 2304w" sizes="(min-width: 2304px) 2304px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2304px) 2304px, 100vw" decoding="async" loading="lazy" data-src="./static/9618d5fdc8e5eb544b96e636d53cf813/6b1b8/08_fractals_25.png" data-srcset="./static/9618d5fdc8e5eb544b96e636d53cf813/513ae/08_fractals_25.png 576w,./static/9618d5fdc8e5eb544b96e636d53cf813/5a25a/08_fractals_25.png 1152w,./static/9618d5fdc8e5eb544b96e636d53cf813/6b1b8/08_fractals_25.png 2304w" alt="Малюнок 8.21: Множина Кантора, виражена алфавітом L-системи"/></picture><noscript><picture><source type="image/webp" srcSet="./static/9618d5fdc8e5eb544b96e636d53cf813/2814d/08_fractals_25.webp 576w,./static/9618d5fdc8e5eb544b96e636d53cf813/5a019/08_fractals_25.webp 1152w,./static/9618d5fdc8e5eb544b96e636d53cf813/94d4f/08_fractals_25.webp 2304w" sizes="(min-width: 2304px) 2304px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2304px) 2304px, 100vw" decoding="async" loading="lazy" src="./static/9618d5fdc8e5eb544b96e636d53cf813/6b1b8/08_fractals_25.png" srcSet="./static/9618d5fdc8e5eb544b96e636d53cf813/513ae/08_fractals_25.png 576w,./static/9618d5fdc8e5eb544b96e636d53cf813/5a25a/08_fractals_25.png 1152w,./static/9618d5fdc8e5eb544b96e636d53cf813/6b1b8/08_fractals_25.png 2304w" alt="Малюнок 8.21: Множина Кантора, виражена алфавітом L-системи"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div>
  <figcaption>Малюнок 8.21: Множина Кантора, виражена алфавітом L-системи</figcaption>
</figure>
<p>Здається знайомим? Ця L-система породила множину Кантора!</p>
<p>Для простоти я використовую <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">AB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span></span> як алфавіт, але багато L-систем замість них використовують символ и <span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo separator="true">,</mo><mi>G</mi><mo separator="true">,</mo><mo>+</mo><mo separator="true">,</mo><mtext>–</mtext><mo separator="true">,</mo><mo stretchy="false">[</mo><mo separator="true">,</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">F, G, +, –, [, ]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">F</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">G</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">+</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">–</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mopen">[</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mclose">]</span></span></span></span></span>. Ось що вони означають:</p>
<table><tbody><tr><td style="width:50px"><span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">F</span></span></span></span></span></td><td>Намалювати лінію і рухатися вперед.</td></tr><tr><td><span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">G</span></span></span></span></span></td><td>Рухатися вперед (без малювання лінії).</td></tr><tr><td><span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>+</mo></mrow><annotation encoding="application/x-tex">+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em"></span><span class="mord">+</span></span></span></span></span></td><td>Поворот праворуч.</td></tr><tr><td><span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo></mrow><annotation encoding="application/x-tex">-</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em"></span><span class="mord">−</span></span></span></span></span></td><td>Поворот ліворуч.</td></tr><tr><td><span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo></mrow><annotation encoding="application/x-tex">[</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span></span></span></span></span></td><td>Збереження поточного стану.</td></tr><tr><td><span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mclose">]</span></span></span></span></span></td><td>Відновлення до збереженого стану.</td></tr></tbody></table>
<div class="avoid-break">
  <p>Цей тип схеми малювання часто називають <strong>черепаховою графікою</strong> (зі старих часів програмування на мові Logo). Уявіть собі черепаху, яка сидить на вашому полотні p5.js і здатна приймати невеликий набір команд: поворот ліворуч, поворот праворуч, рух вперед, малювання лінії тощо. Хоча p5.js не налаштовано для роботи таким чином за замовчуванням, я можу досить легко емулювати графічний механізм черепахової графіки за допомогою функцій <code>translate()</code>, <code>rotate()</code> та <code>line()</code>. Ось як би я перетворив цей алфавіт L-системи у код на p5.js:</p>
</div>
<table><tbody><tr><td><span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">F</span></span></span></span></span></td><td>
        <pre><code>line(0, 0, 0, length);
translate(0, length);</code></pre>
      </td></tr><tr><td><span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">G</span></span></span></span></span></td><td>
        <pre><code>translate(0, length);</code></pre>
      </td></tr><tr><td><span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>+</mo></mrow><annotation encoding="application/x-tex">+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em"></span><span class="mord">+</span></span></span></span></span></td><td>
        <pre><code>rotate(angle);</code></pre>
      </td></tr><tr><td><span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo></mrow><annotation encoding="application/x-tex">-</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em"></span><span class="mord">−</span></span></span></span></span></td><td>
        <pre><code>rotate(-angle);</code></pre>
      </td></tr><tr><td><span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo></mrow><annotation encoding="application/x-tex">[</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span></span></span></span></span></td><td>
        <pre><code>push();</code></pre>
      </td></tr><tr><td><span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mclose">]</span></span></span></span></span></td><td>
        <pre><code>pop();</code></pre>
      </td></tr></tbody></table>
<p>Припускаючи, що я генерую речення з L-системи, я можу повторювати речення символ за символом і виконувати відповідний код для кожного символу:</p>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; sentence.<span class="hljs-property">length</span>; i++) {
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">let</span> c = sentence.<span class="hljs-title function_">charAt</span>(i);
</code></pre><div class="comment"><p>Переглянемо по черзі кожний символ.</p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">if</span> (c === <span class="hljs-string">&#x27;F&#x27;</span>) {
    <span class="hljs-title function_">line</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, length, <span class="hljs-number">0</span>);
    <span class="hljs-title function_">translate</span>(length, <span class="hljs-number">0</span>);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (c === <span class="hljs-string">&#x27;G&#x27;</span>) {
    <span class="hljs-title function_">translate</span>(length, <span class="hljs-number">0</span>);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (c === <span class="hljs-string">&#x27;+&#x27;</span>) {
    <span class="hljs-title function_">rotate</span>(angle);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (c === <span class="hljs-string">&#x27;-&#x27;</span>) {
    <span class="hljs-title function_">rotate</span>(-angle);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (c === <span class="hljs-string">&#x27;[&#x27;</span>) {
    <span class="hljs-title function_">push</span>();
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (c === <span class="hljs-string">&#x27;]&#x27;</span>) {
    <span class="hljs-title function_">pop</span>();
  }
</code></pre><div class="comment"><p>Виконуємо правильну дію для кожного символа.
Все це також можна написати за допомогою оператора switch,
який може бути зручнішим, але я залишив цю частину
як набір умовних операторів if...else, щоб допомогти читачам, які ще не знайомі зі згаданим синтаксисом.</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">}
</code></pre><div class="comment"><p></p></div></div></div>
<p>За допомогою цього коду та правильних умов L-системи я можу малювати неймовірно складні структури схожі на рослини. Ось L-система, яку я буду використовувати для наступного пр икладу:</p>
<table><tbody><tr><td>Алфавіт</td><td><span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo separator="true">,</mo><mi>G</mi><mo separator="true">,</mo><mo>+</mo><mo separator="true">,</mo><mtext>–</mtext><mo separator="true">,</mo><mo stretchy="false">[</mo><mo separator="true">,</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">F, G, +, –, [, ]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">F</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">G</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">+</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">–</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mopen">[</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mclose">]</span></span></span></span></span></td></tr><tr><td>Аксіома</td><td><span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">F</span></span></span></span></span></td></tr><tr><td>Правила</td><td><span data-type="equation" class="math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>→</mo><mi>F</mi><mi>F</mi><mo>+</mo><mo stretchy="false">[</mo><mo>+</mo><mi>F</mi><mo>−</mo><mi>F</mi><mo>−</mo><mi>F</mi><mo stretchy="false">]</mo><mo>−</mo><mo stretchy="false">[</mo><mo>−</mo><mi>F</mi><mo>+</mo><mi>F</mi><mo>+</mo><mi>F</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">F → FF+[+F-F-F]-[-F+F+F]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">F</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">FF</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord">+</span><span class="mord mathnormal" style="margin-right:0.13889em">F</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">F</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">F</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin"> −</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.13889em">F</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">F</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">F</span><span class="mclose">]</span></span></span></span></span></td></tr></tbody></table>
<p>Програма доступна для завантаження на вебсайті книги містить увесь код L-системи, наданий у цьому розділі й організовує його у трьох складових:</p>
<ul>
  <li><code>rules</code>: JavaScript об’єкт, який зберігає пари рядків-попередників і рядків-наступників для правила L-системи</li>
  <li><code>LSystem</code>: клас для ітерації нового покоління L-системи</li>
  <li><code>Turtle</code>: клас для керування читання речення L-системи й виконання його інструкцій для малювання на екрані</li>
</ul>
<p>Я не буду описувати тут ці класи, оскільки вони просто дублюють код, який я вже опрацьовував у цьому розділі. Натомість я покажу, я к усі елементи поєднуються в основному файлі <em>sketch.js</em>.</p>
<div data-type="example">
  <h3 id="example-89-an-l-system"><a class="heading-link" href="#example-89-an-l-system">Приклад 8.9: L-система</a></h3>
  <figure>
    <div class="not-prose clear-both my-4 overflow-hidden rounded border bg-gray-100" style="max-width:1152px"><div class="relative overflow-hidden rounded-t bg-white"><!-- <div class="absolute left-[50%] top-[50%] -translate-x-[50%] -translate-y-[50%] ">Loading sketch ...</div> --><iframe class="w-full border-none transition-opacity opacity-1000" style="aspect-ratio:2.667" loading="lazy" src="./examples/08_fractals/example_8_9_l_system"></iframe></div><div class="flex items-center justify-between border-t"><div class="flex"><button class="flex items-center border-r px-2.5 py-1.5 text-sm hover:bg-gray-200"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true" class="h-[15px] w-[15px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg><span class="ml-1.5">Reset</span></button><button class="flex items-center border-r px-2.5 py-1.5 text-sm hover:bg-gray-200"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span class="ml-1">Pause</span></button></div><a href="https://editor.p5js.org/natureofcode/sketches/KyFcxuFx_" target="_blank" rel="noreferrer" class="flex items-center px-2.5 text-[0.8rem] hover:underline">Open in Web Editor<svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="ml-1 text-gray-500" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></a></div></div>
    <figcaption></figcaption>
  </figure>
</div>
<div class="codesplit callout not-prose" data-code-language="javascript"><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">let</span> lsystem;
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">let</span> turtle;
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">createCanvas</span>(<span class="hljs-number">640</span>, <span class="hljs-number">240</span>);
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">let</span> rules = {
    <span class="hljs-string">&quot;F&quot;</span>: <span class="hljs-string">&quot;FF+[+F-F-F]-[-F+F+F]&quot;</span>,
  };
</code></pre><div class="comment"><p>Правила можна визначити як JavaScript об’єкт.</p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  lsystem = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LSystem</span>(<span class="hljs-string">&quot;F&quot;</span>, rules);
</code></pre><div class="comment"><p>L-система створена за допомогою аксіоми та набору правил.</p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++) {
    lsystem.<span class="hljs-title function_">generate</span>();
  }
</code></pre><div class="comment"><p>Проведення L-системи через чотири покоління.</p></div></div><div class="offset pair split"><pre><code class="hljs code language-javascript">  turtle = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Turtle</span>(<span class="hljs-number">4</span>, <span class="hljs-title function_">radians</span>(<span class="hljs-number">25</span>));
}
</code></pre><div class="comment"><p>Об’єкт Turtle має довжину та кут.</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">draw</span>(<span class="hljs-params"></span>) {
</code></pre><div class="comment"><p></p></div></div><div class="pair"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">background</span>(<span class="hljs-number">255</span>);
</code></pre><div class="comment"><p></p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  <span class="hljs-title function_">translate</span>(width / <span class="hljs-number">2</span>, height);
</code></pre><div class="comment"><p>Починаємо з нижньої частини полотна.</p></div></div><div class="pair split"><pre><code class="hljs code language-javascript">  turtle.<span class="hljs-title function_">render</span>(lsystem.<span class="hljs-property">sentence</span>);
</code></pre><div class="comment"><p>Просимо Turtle відобразити речення.</p></div></div><div class="pair"><pre><code class="hljs code language-javascript">}
</code></pre><div class="comment"><p></p></div></div></div>
<p>У цій книзі я детально розглядав ООП у контексті таких класів, як <code>Particle</code> і <code>p5.Vector</code>. Однак у прикладі 8.9 ви можливо помітили простий об’єкт, який я використав під час ініціалізації змінної <code>rules</code>. Замість визначення класу <code>Rule</code> і виклику його конструктора з ключовим словом <code>new</code>, я ініціалізував змінну літералом об’єкта JavaScript. Завдяки парам ключ-значення це зручна структура даних для визначення правил перетворення для L-системи. Кожен ключ представляє символ у поточному поколінні, який потрібно замінити (у цьому випадку є лише один <code>&quot;F&quot;</code>), а значення цього ключа визначає заміну (<code>&quot;FF+[+F-F-F]-[-F+F+F]&quot;</code>). Хоча в цьому прикладі лише одне правило, ви можете створити додаткові правила як інші пари ключ-значення в літералі об’єкта.</p>
<div data-type="exercise" class="callout">
  <h3 id="exercise-811"><a class="heading-link" href="#exercise-811">Вправа 8.11</a></h3>
  <p>Використовуйте L-систему як набір інструкцій для створення об’єктів, що зберігаються в масиві. Використовуйте тригонометрію т а векторну математику, щоб виконати обертання без трансформацій (так само як я зробив із кривою Коха в прикладі 8.5).</p>
</div>
<div data-type="exercise" class="callout">
  <h3 id="exercise-812"><a class="heading-link" href="#exercise-812">Вправа 8.12</a></h3>
  <p>Фундаментальна робота з L-систем і рослинних структур <a href="http://algorithmicbotany.org/papers/abop/abop.pdf" target="_blank" rel="noopener"><em>Алгоритмічна краса рослин</em></a> під авторством Пшемислава Прусінкевича й Арістіда Лінденмаєра була опублікована в 1990 році. У першому розділі описано багато складних L-систем з додатковими правилами малювання та доступними символами алфавіту. Він також описує кілька методів генерації стохастичних <span style="white-space:nowrap">L-систем</span>. Розширте код L-системи в прикладі 8.9, щоб включити одну або більше додаткових функцій, описаних Прусінкевичем і Лінденмаєром.</p>
</div>
<div data-type="exercise" class="callout">
  <h3 id="exercise-813"><a class="heading-link" href="#exercise-813">Вправа 8.13</a></h3>
  <p>У цьому розділі я наголошував на використанні фрактальних алгоритмів для створення візуальних патернів. Однак фрактали можна знайти й в інших творчих середовищах. Наприклад, вони притаманні “<em>Сюїті для віолончелі №3</em>” Йоганна Себастьяна Баха, а структура роману Дев іда Фостера Уоллеса “<em>Нескінченний жарт</em>“ була натхненна фракталами. Розгляньте можливість використання прикладів цього розділу для створення аудіо або тексту.</p>
</div>
<div data-type="project" class="callout">
  <h3 id="the-ecosystem-project-9"><a class="heading-link" href="#the-ecosystem-project-9">Проєкт “Екосистема”</a></h3>
  <p>Залучіть у свою екосистему фрактали. Ось кілька можливостей:</p>
  <ul>
    <li>Додайте до середовища екосистеми рослиноподібні створіння.</li>
    <li>Скажімо, одна з ваших рослин схожа на фрактальне дерево. Чи можете ви додати листя, чи квіти на кінці гілок? Що робити, якщо листя може опадати з дерева (залежно від сили вітру)? Що, якщо додати фрукти, які істоти зможуть зривати та їсти?</li>
    <li>Спроєктуйте створіння з фрактальним візерунком.</li>
    <li>Використайте L-систему, щоб створити інструкції для руху створіння або його поведінки.</li>
  </ul>
  <figure>
    <div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:2304px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;1420&#x27; width=&#x27;2304&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#b8b8b8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="./static/8f8f0f7b1940b3579b242b0666f2801c/be6fc/08_fractals_26.webp 576w,./static/8f8f0f7b1940b3579b242b0666f2801c/7c4ba/08_fractals_26.webp 1152w,./static/8f8f0f7b1940b3579b242b0666f2801c/2e9c6/08_fractals_26.webp 2304w" sizes="(min-width: 2304px) 2304px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2304px) 2304px, 100vw" decoding="async" loading="lazy" data-src="./static/8f8f0f7b1940b3579b242b0666f2801c/43bff/08_fractals_26.png" data-srcset="./static/8f8f0f7b1940b3579b242b0666f2801c/09264/08_fractals_26.png 576w,./static/8f8f0f7b1940b3579b242b0666f2801c/8a8ae/08_fractals_26.png 1152w,./static/8f8f0f7b1940b3579b242b0666f2801c/43bff/08_fractals_26.png 2304w" alt=""/></picture><noscript><picture><source type="image/webp" srcSet="./static/8f8f0f7b1940b3579b242b0666f2801c/be6fc/08_fractals_26.webp 576w,./static/8f8f0f7b1940b3579b242b0666f2801c/7c4ba/08_fractals_26.webp 1152w,./static/8f8f0f7b1940b3579b242b0666f2801c/2e9c6/08_fractals_26.webp 2304w" sizes="(min-width: 2304px) 2304px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2304px) 2304px, 100vw" decoding="async" loading="lazy" src="./static/8f8f0f7b1940b3579b242b0666f2801c/43bff/08_fractals_26.png" srcSet="./static/8f8f0f7b1940b3579b242b0666f2801c/09264/08_fractals_26.png 576w,./static/8f8f0f7b1940b3579b242b0666f2801c/8a8ae/08_fractals_26.png 1152w,./static/8f8f0f7b1940b3579b242b0666f2801c/43bff/08_fractals_26.png 2304w" alt=""/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div>
    <figcaption></figcaption>
  </figure>
</div>
</section>
<hr/><section class="not-prose flex w-full justify-between"><div><a class="group block" href="./cellular-automata.html"><p class="text-gray-500">Попередній розділ</p><span class="text-lg font-semibold group-hover:underline">← <!-- -->7. Клітинні автомати</span></a></div><div><a class="group block text-right" href="./genetic-algorithms.html"><p class="text-gray-500">Наступний розділм</p><span class="text-lg font-semibold group-hover:underline">9. Еволюційне моделювання<!-- --> →</span></a></div></section></main></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div>
<script src="./assets/js/main.js"></script>
</body></html>